"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=_interopRequireWildcard(require("react")),_reactDropzone=_interopRequireDefault(require("react-dropzone")),_GFDropzone=_interopRequireDefault(require("./GFDropzone"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return _getRequireWildcardCache=function(){return a},a}function _interopRequireWildcard(a){if(a&&a.__esModule)return a;if(null===a||"object"!==_typeof(a)&&"function"!=typeof a)return{default:a};var b=_getRequireWildcardCache();if(b&&b.has(a))return b.get(a);var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a)if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;f&&(f.get||f.set)?Object.defineProperty(c,e,f):c[e]=a[e]}return c["default"]=a,b&&b.set(a,c),c}function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _possibleConstructorReturn(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:_assertThisInitialized(a)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var Fileupload=function(a){function b(){var a,c;_classCallCheck(this,b);for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=_possibleConstructorReturn(this,(a=_getPrototypeOf(b)).call.apply(a,[this].concat(e))),_defineProperty(_assertThisInitialized(c),"state",{imagePreviewUrl:c.props.field.preview||null,selectedFile:!!c.props.field.preview||null,uploadFileText:"No file chosen",previewID:c.props.value||null,errorText:c.props.error||!1}),_defineProperty(_assertThisInitialized(c),"inputFile",_react["default"].createRef()),_defineProperty(_assertThisInitialized(c),"onChangeHandler",function(a){var b=c.props.field,d=b.hasPreview,e=b.allowedExtensions;if(c.setState({imagePreviewUrl:null,selectedFile:a.target.files[0],uploadFileText:a.target.files[0]?a.target.files[0].name:"No file chosen"}),d&&a.target&&a.target.files[0]){var f=a.target.files[0].name.split(".").pop().toLowerCase(),g=-1<e.indexOf(f);if(g){var h=new FileReader;h.onloadend=function(){c.setState({imagePreviewUrl:h.result,previewID:!1})},h.readAsDataURL(a.target.files[0])}}}),_defineProperty(_assertThisInitialized(c),"removeFilePreview",function(){var a=c.props,b=a.field,d=a.unsetError;c.inputFile.current.value="",c.setState({imagePreviewUrl:null,selectedFile:null,previewID:!1}),d(b.id)}),_defineProperty(_assertThisInitialized(c),"prepareAllowedTypes",function(a){var b=a.split(",");return b=b.map(function(a){return".".concat(a.replace(/\s/g,""))}).join(", "),b}),_defineProperty(_assertThisInitialized(c),"onButtonClickHandler",function(){c.inputFile.current.click()}),c}return _inherits(b,a),_createClass(b,[{key:"render",value:function render(){var a=this,b=this.state,c=b.selectedFile,d=b.uploadFileText,e=b.imagePreviewUrl,f=b.previewID,g=this.props,h=g.field,i=g.value,j=g.validationMessage,k=g.touched,l=g.setTouched,m=g.hideField,n=g.updateForm,o=g.formID,p=g.fieldError,q=g.styledComponents,r=g.error,s=g.unsetError,t=g.dropzoneText,u=h.id,v=h.type,w=h.label,x=h.cssClass,y=h.isRequired,z=h.description,A=h.descriptionPlacement,B=h.labelPlacement,C=h.width,D=h.allowedExtensions,E=h.buttonText,F=h.hasPreview,G=h.maxFileSize,H=q||!1,I=H.Button,J=void 0===I?"button":I,K=H.Label,L=void 0===K?"label":K,M=H.FileWrapper,N=void 0===M?"div":M,O=H.Box,P=void 0===O?"div":O,Q=-1<x.indexOf("dropzone");return _react["default"].createElement(P,{width:C,className:j&&k||r?"form-field error ".concat(x):"form-field ".concat(x),style:{display:m?"none":void 0}},_react["default"].createElement(N,{className:v},_react["default"].createElement(L,{htmlFor:"input_".concat(o,"_").concat(u),className:"gf-label ".concat(B)},w,y?_react["default"].createElement("abbr",null,"*"):null),"above"===A&&z?z&&_react["default"].createElement("div",{className:"description"},z):Q?_react["default"].createElement(_GFDropzone["default"],{dropzoneText:t,field:h,id:u,formID:o,isRequired:y,updateForm:n,setTouched:l,unsetError:s}):_react["default"].createElement(_react["default"].Fragment,null,G&&_react["default"].createElement("input",{type:"hidden",name:"MAX_FILE_SIZE",value:1048576*G}),_react["default"].createElement("input",{id:"input_".concat(o,"_").concat(u),name:"input_".concat(u),type:"file",required:y,ref:this.inputFile,onChange:function onChange(b){a.onChangeHandler(b),n(b,h),l(u),s(u)},onBlur:function onBlur(a){n(a,h),l(u)},accept:this.prepareAllowedTypes(D)||void 0,"aria-label":w,"aria-describedby":"error_".concat(o,"_").concat(u),"aria-invalid":!!j||!!r,hidden:"hidden"}),f&&h.preview&&_react["default"].createElement("input",{type:"hidden",name:"file-upload-preview",value:f}),F&&_react["default"].createElement("div",{className:"file-preview",style:c&&e?{backgroundImage:"url(".concat(e,")")}:void 0},c&&e&&_react["default"].createElement("button",{type:"button",className:"remove-file",onClick:function onClick(){return a.removeFilePreview()}})),_react["default"].createElement("div",{"aria-pressed":"false",tabIndex:"0",role:"button",className:"fileUpload",onClick:this.onButtonClickHandler},_react["default"].createElement(J,{color:"yellow",tabIndex:"-1",type:"button"},E||"Choose a file"),_react["default"].createElement("span",null,d)),z&&_react["default"].createElement("div",{className:"description"},z)),(j&&k||r)&&_react["default"].createElement("span",{className:"error-message",id:"error_".concat(u)},j||r),p&&_react["default"].createElement("span",{className:"error-message",id:"error_".concat(o,"_").concat(u)},p)))}}]),b}(_react.Component),_default=Fileupload;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9GaWVsZHMvRmlsZXVwbG9hZC9GaWxldXBsb2FkLmpzeCJdLCJuYW1lcyI6WyJGaWxldXBsb2FkIiwiaW1hZ2VQcmV2aWV3VXJsIiwicHJvcHMiLCJmaWVsZCIsInByZXZpZXciLCJzZWxlY3RlZEZpbGUiLCJ1cGxvYWRGaWxlVGV4dCIsInByZXZpZXdJRCIsInZhbHVlIiwiZXJyb3JUZXh0IiwiZXJyb3IiLCJSZWFjdCIsImNyZWF0ZVJlZiIsImV2ZW50IiwiaGFzUHJldmlldyIsImFsbG93ZWRFeHRlbnNpb25zIiwic2V0U3RhdGUiLCJ0YXJnZXQiLCJmaWxlcyIsIm5hbWUiLCJleHRlbnNpb24iLCJzcGxpdCIsInBvcCIsInRvTG93ZXJDYXNlIiwiaXNTdWNjZXNzIiwiaW5kZXhPZiIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWRlbmQiLCJyZXN1bHQiLCJyZWFkQXNEYXRhVVJMIiwidW5zZXRFcnJvciIsImlucHV0RmlsZSIsImN1cnJlbnQiLCJpZCIsInR5cGVzIiwiYWNjZXB0IiwibWFwIiwic3RyIiwicmVwbGFjZSIsImpvaW4iLCJjbGljayIsInN0YXRlIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJ0b3VjaGVkIiwic2V0VG91Y2hlZCIsImhpZGVGaWVsZCIsInVwZGF0ZUZvcm0iLCJmb3JtSUQiLCJmaWVsZEVycm9yIiwic3R5bGVkQ29tcG9uZW50cyIsImRyb3B6b25lVGV4dCIsInR5cGUiLCJsYWJlbCIsImNzc0NsYXNzIiwiaXNSZXF1aXJlZCIsImRlc2NyaXB0aW9uIiwiZGVzY3JpcHRpb25QbGFjZW1lbnQiLCJsYWJlbFBsYWNlbWVudCIsIndpZHRoIiwiYnV0dG9uVGV4dCIsIm1heEZpbGVTaXplIiwiQnV0dG9uIiwiTGFiZWwiLCJGaWxlV3JhcHBlciIsIkJveCIsImhhc0Ryb3B6b25lIiwiZGlzcGxheSIsIm9uQ2hhbmdlSGFuZGxlciIsInByZXBhcmVBbGxvd2VkVHlwZXMiLCJiYWNrZ3JvdW5kSW1hZ2Ui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QixXQTRNVnpFLFUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IERyb3B6b25lIGZyb20gJ3JlYWN0LWRyb3B6b25lJztcbmltcG9ydCBHRkRyb3B6b25lIGZyb20gJy4vR0ZEcm9wem9uZSc7XG5cbmNsYXNzIEZpbGV1cGxvYWQgZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0ZSA9IHtcbiAgICBpbWFnZVByZXZpZXdVcmw6IHRoaXMucHJvcHMuZmllbGQucHJldmlldyB8fCBudWxsLFxuICAgIHNlbGVjdGVkRmlsZTogdGhpcy5wcm9wcy5maWVsZC5wcmV2aWV3ID8gdHJ1ZSA6IG51bGwsXG4gICAgdXBsb2FkRmlsZVRleHQ6ICdObyBmaWxlIGNob3NlbicsXG4gICAgcHJldmlld0lEOiB0aGlzLnByb3BzLnZhbHVlIHx8IG51bGwsXG4gICAgZXJyb3JUZXh0OiB0aGlzLnByb3BzLmVycm9yIHx8IGZhbHNlLFxuICB9O1xuXG4gIGlucHV0RmlsZSA9IFJlYWN0LmNyZWF0ZVJlZigpO1xuXG4gIG9uQ2hhbmdlSGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgIGNvbnN0IHsgaGFzUHJldmlldywgYWxsb3dlZEV4dGVuc2lvbnMgfSA9IHRoaXMucHJvcHMuZmllbGQ7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBpbWFnZVByZXZpZXdVcmw6IG51bGwsXG4gICAgICBzZWxlY3RlZEZpbGU6IGV2ZW50LnRhcmdldC5maWxlc1swXSxcbiAgICAgIHVwbG9hZEZpbGVUZXh0OiBldmVudC50YXJnZXQuZmlsZXNbMF0gPyBldmVudC50YXJnZXQuZmlsZXNbMF0ubmFtZSA6ICdObyBmaWxlIGNob3NlbicsXG4gICAgfSk7XG5cbiAgICBpZiAoaGFzUHJldmlldyAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LmZpbGVzWzBdKSB7XG4gICAgICAvLyBjaGVjayBmaWxlIHR5cGVcbiAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IGV2ZW50LnRhcmdldC5maWxlc1swXS5uYW1lXG4gICAgICAgIC5zcGxpdCgnLicpXG4gICAgICAgIC5wb3AoKVxuICAgICAgICAudG9Mb3dlckNhc2UoKTsgLy8gZmlsZSBleHRlbnNpb24gZnJvbSBpbnB1dCBmaWxlXG4gICAgICBjb25zdCBpc1N1Y2Nlc3MgPSBhbGxvd2VkRXh0ZW5zaW9ucy5pbmRleE9mKGV4dGVuc2lvbikgPiAtMTsgLy8gaXMgZXh0ZW5zaW9uIGluIGFjY2VwdGFibGUgdHlwZXNcbiAgICAgIGlmIChpc1N1Y2Nlc3MpIHtcbiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICByZWFkZXIub25sb2FkZW5kID0gKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaW1hZ2VQcmV2aWV3VXJsOiByZWFkZXIucmVzdWx0LFxuICAgICAgICAgICAgcHJldmlld0lEOiBmYWxzZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChldmVudC50YXJnZXQuZmlsZXNbMF0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZW1vdmVGaWxlUHJldmlldyA9ICgpID0+IHtcbiAgICBjb25zdCB7IGZpZWxkLCB1bnNldEVycm9yIH0gPSB0aGlzLnByb3BzO1xuICAgIHRoaXMuaW5wdXRGaWxlLmN1cnJlbnQudmFsdWUgPSAnJztcbiAgICB0aGlzLnNldFN0YXRlKHsgaW1hZ2VQcmV2aWV3VXJsOiBudWxsLCBzZWxlY3RlZEZpbGU6IG51bGwsIHByZXZpZXdJRDogZmFsc2UgfSk7XG4gICAgdW5zZXRFcnJvcihmaWVsZC5pZCk7XG4gIH07XG5cbiAgcHJlcGFyZUFsbG93ZWRUeXBlcyA9ICh0eXBlcykgPT4ge1xuICAgIGxldCBhY2NlcHQgPSB0eXBlcy5zcGxpdCgnLCcpO1xuICAgIGFjY2VwdCA9IGFjY2VwdC5tYXAoKHN0cikgPT4gYC4ke3N0ci5yZXBsYWNlKC9cXHMvZywgJycpfWApLmpvaW4oJywgJyk7XG4gICAgcmV0dXJuIGFjY2VwdDtcbiAgfTtcblxuICBvbkJ1dHRvbkNsaWNrSGFuZGxlciA9ICgpID0+IHtcbiAgICB0aGlzLmlucHV0RmlsZS5jdXJyZW50LmNsaWNrKCk7XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRGaWxlLCB1cGxvYWRGaWxlVGV4dCwgaW1hZ2VQcmV2aWV3VXJsLCBwcmV2aWV3SUQgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICBjb25zdCB7XG4gICAgICBmaWVsZCxcbiAgICAgIHZhbHVlLFxuICAgICAgdmFsaWRhdGlvbk1lc3NhZ2UsXG4gICAgICB0b3VjaGVkLFxuICAgICAgc2V0VG91Y2hlZCxcbiAgICAgIGhpZGVGaWVsZCxcbiAgICAgIHVwZGF0ZUZvcm0sXG4gICAgICBmb3JtSUQsXG4gICAgICBmaWVsZEVycm9yLFxuICAgICAgc3R5bGVkQ29tcG9uZW50cyxcbiAgICAgIGVycm9yLFxuICAgICAgdW5zZXRFcnJvcixcbiAgICAgIGRyb3B6b25lVGV4dCxcbiAgICB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7XG4gICAgICBpZCxcbiAgICAgIHR5cGUsXG4gICAgICBsYWJlbCxcbiAgICAgIGNzc0NsYXNzLFxuICAgICAgaXNSZXF1aXJlZCxcbiAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgZGVzY3JpcHRpb25QbGFjZW1lbnQsXG4gICAgICBsYWJlbFBsYWNlbWVudCxcbiAgICAgIHdpZHRoLFxuICAgICAgYWxsb3dlZEV4dGVuc2lvbnMsXG4gICAgICBidXR0b25UZXh0LFxuICAgICAgaGFzUHJldmlldyxcbiAgICAgIG1heEZpbGVTaXplLFxuICAgIH0gPSBmaWVsZDtcbiAgICBjb25zdCB7IEJ1dHRvbiA9ICdidXR0b24nLCBMYWJlbCA9ICdsYWJlbCcsIEZpbGVXcmFwcGVyID0gJ2RpdicsIEJveCA9ICdkaXYnIH0gPVxuICAgICAgc3R5bGVkQ29tcG9uZW50cyB8fCBmYWxzZTtcblxuICAgIGNvbnN0IGhhc0Ryb3B6b25lID0gY3NzQ2xhc3MuaW5kZXhPZignZHJvcHpvbmUnKSA+IC0xO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxCb3hcbiAgICAgICAgd2lkdGg9e3dpZHRofVxuICAgICAgICBjbGFzc05hbWU9e1xuICAgICAgICAgICh2YWxpZGF0aW9uTWVzc2FnZSAmJiB0b3VjaGVkKSB8fCBlcnJvclxuICAgICAgICAgICAgPyBgZm9ybS1maWVsZCBlcnJvciAke2Nzc0NsYXNzfWBcbiAgICAgICAgICAgIDogYGZvcm0tZmllbGQgJHtjc3NDbGFzc31gXG4gICAgICAgIH1cbiAgICAgICAgc3R5bGU9e3sgZGlzcGxheTogaGlkZUZpZWxkID8gJ25vbmUnIDogdW5kZWZpbmVkIH19XG4gICAgICA+XG4gICAgICAgIDxGaWxlV3JhcHBlciBjbGFzc05hbWU9e3R5cGV9PlxuICAgICAgICAgIDxMYWJlbCBodG1sRm9yPXtgaW5wdXRfJHtmb3JtSUR9XyR7aWR9YH0gY2xhc3NOYW1lPXtgZ2YtbGFiZWwgJHtsYWJlbFBsYWNlbWVudH1gfT5cbiAgICAgICAgICAgIHtsYWJlbH1cbiAgICAgICAgICAgIHtpc1JlcXVpcmVkID8gPGFiYnI+KjwvYWJicj4gOiBudWxsfVxuICAgICAgICAgIDwvTGFiZWw+XG4gICAgICAgICAge2Rlc2NyaXB0aW9uUGxhY2VtZW50ID09PSAnYWJvdmUnICYmIGRlc2NyaXB0aW9uID8gKFxuICAgICAgICAgICAgZGVzY3JpcHRpb24gJiYgPGRpdiBjbGFzc05hbWU9XCJkZXNjcmlwdGlvblwiPntkZXNjcmlwdGlvbn08L2Rpdj5cbiAgICAgICAgICApIDogaGFzRHJvcHpvbmUgPyAoXG4gICAgICAgICAgICA8R0ZEcm9wem9uZVxuICAgICAgICAgICAgICBkcm9wem9uZVRleHQ9e2Ryb3B6b25lVGV4dH1cbiAgICAgICAgICAgICAgZmllbGQ9e2ZpZWxkfVxuICAgICAgICAgICAgICBpZD17aWR9XG4gICAgICAgICAgICAgIGZvcm1JRD17Zm9ybUlEfVxuICAgICAgICAgICAgICBpc1JlcXVpcmVkPXtpc1JlcXVpcmVkfVxuICAgICAgICAgICAgICB1cGRhdGVGb3JtPXt1cGRhdGVGb3JtfVxuICAgICAgICAgICAgICBzZXRUb3VjaGVkPXtzZXRUb3VjaGVkfVxuICAgICAgICAgICAgICB1bnNldEVycm9yPXt1bnNldEVycm9yfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICB7bWF4RmlsZVNpemUgJiYgKFxuICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIk1BWF9GSUxFX1NJWkVcIiB2YWx1ZT17bWF4RmlsZVNpemUgKiAxMDQ4NTc2fSAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICBpZD17YGlucHV0XyR7Zm9ybUlEfV8ke2lkfWB9XG4gICAgICAgICAgICAgICAgbmFtZT17YGlucHV0XyR7aWR9YH1cbiAgICAgICAgICAgICAgICB0eXBlPVwiZmlsZVwiXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ9e2lzUmVxdWlyZWR9XG4gICAgICAgICAgICAgICAgcmVmPXt0aGlzLmlucHV0RmlsZX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlSGFuZGxlcihldmVudCk7XG4gICAgICAgICAgICAgICAgICB1cGRhdGVGb3JtKGV2ZW50LCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgICBzZXRUb3VjaGVkKGlkKTtcbiAgICAgICAgICAgICAgICAgIHVuc2V0RXJyb3IoaWQpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgb25CbHVyPXsoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgIHVwZGF0ZUZvcm0oZXZlbnQsIGZpZWxkKTtcbiAgICAgICAgICAgICAgICAgIHNldFRvdWNoZWQoaWQpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgYWNjZXB0PXt0aGlzLnByZXBhcmVBbGxvd2VkVHlwZXMoYWxsb3dlZEV4dGVuc2lvbnMpIHx8IHVuZGVmaW5lZH1cbiAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPXtsYWJlbH1cbiAgICAgICAgICAgICAgICBhcmlhLWRlc2NyaWJlZGJ5PXtgZXJyb3JfJHtmb3JtSUR9XyR7aWR9YH1cbiAgICAgICAgICAgICAgICBhcmlhLWludmFsaWQ9eyEhdmFsaWRhdGlvbk1lc3NhZ2UgfHwgISFlcnJvcn1cbiAgICAgICAgICAgICAgICBoaWRkZW49XCJoaWRkZW5cIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB7cHJldmlld0lEICYmIGZpZWxkLnByZXZpZXcgJiYgKFxuICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cImZpbGUtdXBsb2FkLXByZXZpZXdcIiB2YWx1ZT17cHJldmlld0lEfSAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7aGFzUHJldmlldyAmJiAoXG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmlsZS1wcmV2aWV3XCJcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlICYmIGltYWdlUHJldmlld1VybFxuICAgICAgICAgICAgICAgICAgICAgID8geyBiYWNrZ3JvdW5kSW1hZ2U6IGB1cmwoJHtpbWFnZVByZXZpZXdVcmx9KWAgfVxuICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAge3NlbGVjdGVkRmlsZSAmJiBpbWFnZVByZXZpZXdVcmwgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicmVtb3ZlLWZpbGVcIlxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMucmVtb3ZlRmlsZVByZXZpZXcoKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBhcmlhLXByZXNzZWQ9XCJmYWxzZVwiXG4gICAgICAgICAgICAgICAgdGFiSW5kZXg9XCIwXCJcbiAgICAgICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmaWxlVXBsb2FkXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQnV0dG9uQ2xpY2tIYW5kbGVyfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPEJ1dHRvbiBjb2xvcj1cInllbGxvd1wiIHRhYkluZGV4PVwiLTFcIiB0eXBlPVwiYnV0dG9uXCI+XG4gICAgICAgICAgICAgICAgICB7YnV0dG9uVGV4dCB8fCAnQ2hvb3NlIGEgZmlsZSd9XG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPHNwYW4+e3VwbG9hZEZpbGVUZXh0fTwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAge2Rlc2NyaXB0aW9uICYmIDxkaXYgY2xhc3NOYW1lPVwiZGVzY3JpcHRpb25cIj57ZGVzY3JpcHRpb259PC9kaXY+fVxuICAgICAgICAgICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICApfVxuICAgICAgICAgIHsoKHZhbGlkYXRpb25NZXNzYWdlICYmIHRvdWNoZWQpIHx8IGVycm9yKSAmJiAoXG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJlcnJvci1tZXNzYWdlXCIgaWQ9e2BlcnJvcl8ke2lkfWB9PlxuICAgICAgICAgICAgICB7dmFsaWRhdGlvbk1lc3NhZ2UgfHwgZXJyb3J9XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7ZmllbGRFcnJvciAmJiAoXG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJlcnJvci1tZXNzYWdlXCIgaWQ9e2BlcnJvcl8ke2Zvcm1JRH1fJHtpZH1gfT5cbiAgICAgICAgICAgICAge2ZpZWxkRXJyb3J9XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9GaWxlV3JhcHBlcj5cbiAgICAgIDwvQm94PlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRmlsZXVwbG9hZDtcblxuIl19
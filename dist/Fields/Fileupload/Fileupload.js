"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=_interopRequireWildcard(require("react")),_reactDropzone=_interopRequireDefault(require("react-dropzone")),_GFDropzone=_interopRequireDefault(require("./GFDropzone")),_InputLabel=_interopRequireDefault(require("../../FormElements/InputLabel"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return _getRequireWildcardCache=function(){return a},a}function _interopRequireWildcard(a){if(a&&a.__esModule)return a;if(null===a||"object"!==_typeof(a)&&"function"!=typeof a)return{default:a};var b=_getRequireWildcardCache();if(b&&b.has(a))return b.get(a);var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a)if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;f&&(f.get||f.set)?Object.defineProperty(c,e,f):c[e]=a[e]}return c["default"]=a,b&&b.set(a,c),c}function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _createSuper(a){var b=_isNativeReflectConstruct();return function(){var c,d=_getPrototypeOf(a);if(b){var e=_getPrototypeOf(this).constructor;c=Reflect.construct(d,arguments,e)}else c=d.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _possibleConstructorReturn(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:_assertThisInitialized(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var Fileupload=function(a){function b(){var a;_classCallCheck(this,b);for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return a=c.call.apply(c,[this].concat(e)),_defineProperty(_assertThisInitialized(a),"state",{imagePreviewUrl:a.props.field.preview||null,selectedFile:!!a.props.field.preview||null,uploadFileText:"No file chosen",previewID:a.props.value||null,errorText:a.props.error||!1}),_defineProperty(_assertThisInitialized(a),"inputFile",_react["default"].createRef()),_defineProperty(_assertThisInitialized(a),"onChangeHandler",function(b){var c=a.props.field,d=c.hasPreview,e=c.allowedExtensions;if(a.setState({imagePreviewUrl:null,selectedFile:b.target.files[0],uploadFileText:b.target.files[0]?b.target.files[0].name:"No file chosen"}),d&&b.target&&b.target.files[0]){var f=b.target.files[0].name.split(".").pop().toLowerCase(),g=-1<e.indexOf(f);if(g){var h=new FileReader;h.onloadend=function(){a.setState({imagePreviewUrl:h.result,previewID:!1})},h.readAsDataURL(b.target.files[0])}}}),_defineProperty(_assertThisInitialized(a),"removeFilePreview",function(){var b=a.props,c=b.field,d=b.unsetError;a.inputFile.current.value="",a.setState({imagePreviewUrl:null,selectedFile:null,previewID:!1}),d(c.id)}),_defineProperty(_assertThisInitialized(a),"prepareAllowedTypes",function(a){var b=a.split(",");return b=b.map(function(a){return".".concat(a.replace(/\s/g,""))}).join(", "),b}),_defineProperty(_assertThisInitialized(a),"onButtonClickHandler",function(){a.inputFile.current.click()}),a}_inherits(b,a);var c=_createSuper(b);return _createClass(b,[{key:"render",value:function render(){var a=this,b=this.state,c=b.selectedFile,d=b.uploadFileText,e=b.imagePreviewUrl,f=b.previewID,g=this.props,h=g.field,i=g.value,j=g.validationMessage,k=g.touched,l=g.setTouched,m=g.hideField,n=g.updateForm,o=g.formID,p=g.fieldError,q=g.styledComponents,r=g.error,s=g.unsetError,t=g.dropzoneText,u=h.id,v=h.type,w=h.label,x=h.cssClass,y=h.isRequired,z=h.description,A=h.descriptionPlacement,B=h.labelPlacement,C=h.width,D=h.allowedExtensions,E=h.buttonText,F=h.hasPreview,G=h.maxFileSize,H=q||!1,I=H.Button,J=void 0===I?"button":I,K=H.Label,L=void 0===K?"label":K,M=H.FileWrapper,N=void 0===M?"div":M,O=H.Box,P=void 0===O?"div":O,Q=-1<x.indexOf("dropzone");return _react["default"].createElement(P,{width:C,className:j&&k||r?"form-field error ".concat(x):"form-field ".concat(x),style:{display:m?"none":void 0}},_react["default"].createElement(N,{className:v},_react["default"].createElement(_InputLabel["default"],{formId:o,id:u,label:w,labelPlacement:B,isRequired:y,styledComponent:q}),"above"===A&&z?z&&_react["default"].createElement("div",{className:"description"},z):Q?_react["default"].createElement(_GFDropzone["default"],{dropzoneText:t,field:h,id:u,formID:o,isRequired:y,updateForm:n,setTouched:l,unsetError:s}):_react["default"].createElement(_react["default"].Fragment,null,G&&_react["default"].createElement("input",{type:"hidden",name:"MAX_FILE_SIZE",value:1048576*G}),_react["default"].createElement("input",{id:"input_".concat(o,"_").concat(u),name:"input_".concat(u),type:"file",required:y,ref:this.inputFile,onChange:function onChange(b){a.onChangeHandler(b),n(b,h),l(u),s(u)},onBlur:function onBlur(a){n(a,h),l(u)},accept:this.prepareAllowedTypes(D)||void 0,"aria-label":w,"aria-describedby":"error_".concat(o,"_").concat(u),"aria-invalid":!!j||!!r,hidden:"hidden"}),f&&h.preview&&_react["default"].createElement("input",{type:"hidden",name:"file-upload-preview",value:f}),F&&_react["default"].createElement("div",{className:"file-preview",style:c&&e?{backgroundImage:"url(".concat(e,")")}:void 0},c&&e&&_react["default"].createElement("button",{type:"button",className:"remove-file",onClick:function onClick(){return a.removeFilePreview()}})),_react["default"].createElement("div",{"aria-pressed":"false",tabIndex:"0",role:"button",className:"fileUpload",onClick:this.onButtonClickHandler},_react["default"].createElement(J,{color:"yellow",tabIndex:"-1",type:"button"},E||"Choose a file"),_react["default"].createElement("span",null,d)),z&&_react["default"].createElement("div",{className:"description"},z)),(j&&k||r)&&_react["default"].createElement("span",{className:"error-message",id:"error_".concat(u)},j||r),p&&_react["default"].createElement("span",{className:"error-message",id:"error_".concat(o,"_").concat(u)},p)))}}]),b}(_react.Component),_default=Fileupload;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9GaWVsZHMvRmlsZXVwbG9hZC9GaWxldXBsb2FkLmpzeCJdLCJuYW1lcyI6WyJGaWxldXBsb2FkIiwiaW1hZ2VQcmV2aWV3VXJsIiwicHJvcHMiLCJmaWVsZCIsInByZXZpZXciLCJzZWxlY3RlZEZpbGUiLCJ1cGxvYWRGaWxlVGV4dCIsInByZXZpZXdJRCIsInZhbHVlIiwiZXJyb3JUZXh0IiwiZXJyb3IiLCJSZWFjdCIsImNyZWF0ZVJlZiIsImV2ZW50IiwiaGFzUHJldmlldyIsImFsbG93ZWRFeHRlbnNpb25zIiwic2V0U3RhdGUiLCJ0YXJnZXQiLCJmaWxlcyIsIm5hbWUiLCJleHRlbnNpb24iLCJzcGxpdCIsInBvcCIsInRvTG93ZXJDYXNlIiwiaXNTdWNjZXNzIiwiaW5kZXhPZiIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWRlbmQiLCJyZXN1bHQiLCJyZWFkQXNEYXRhVVJMIiwidW5zZXRFcnJvciIsImlucHV0RmlsZSIsImN1cnJlbnQiLCJpZCIsInR5cGVzIiwiYWNjZXB0IiwibWFwIiwic3RyIiwicmVwbGFjZSIsImpvaW4iLCJjbGljayIsInN0YXRlIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJ0b3VjaGVkIiwic2V0VG91Y2hlZCIsImhpZGVGaWVsZCIsInVwZGF0ZUZvcm0iLCJmb3JtSUQiLCJmaWVsZEVycm9yIiwic3R5bGVkQ29tcG9uZW50cyIsImRyb3B6b25lVGV4dCIsInR5cGUiLCJsYWJlbCIsImNzc0NsYXNzIiwiaXNSZXF1aXJlZCIsImRlc2NyaXB0aW9uIiwiZGVzY3JpcHRpb25QbGFjZW1lbnQiLCJsYWJlbFBsYWNlbWVudCIsIndpZHRoIiwiYnV0dG9uVGV4dCIsIm1heEZpbGVTaXplIiwiQnV0dG9uIiwiTGFiZWwiLCJGaWxlV3JhcHBlciIsIkJveCIsImhhc0Ryb3B6b25lIiwiZGlzcGxheSIsIm9uQ2hhbmdlSGFuZGxlciIsInByZXBhcmVBbGxvd2VkVHlwZXMiLCJiYWNrZ3JvdW5kSW1hZ2Ui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R0gsQyxPQTdNc0J3QixnQixXQWdOVnpFLFUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IERyb3B6b25lIGZyb20gJ3JlYWN0LWRyb3B6b25lJztcbmltcG9ydCBHRkRyb3B6b25lIGZyb20gJy4vR0ZEcm9wem9uZSc7XG5pbXBvcnQgSW5wdXRMYWJlbCBmcm9tICcuLi8uLi9Gb3JtRWxlbWVudHMvSW5wdXRMYWJlbCdcblxuY2xhc3MgRmlsZXVwbG9hZCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRlID0ge1xuICAgIGltYWdlUHJldmlld1VybDogdGhpcy5wcm9wcy5maWVsZC5wcmV2aWV3IHx8IG51bGwsXG4gICAgc2VsZWN0ZWRGaWxlOiB0aGlzLnByb3BzLmZpZWxkLnByZXZpZXcgPyB0cnVlIDogbnVsbCxcbiAgICB1cGxvYWRGaWxlVGV4dDogJ05vIGZpbGUgY2hvc2VuJyxcbiAgICBwcmV2aWV3SUQ6IHRoaXMucHJvcHMudmFsdWUgfHwgbnVsbCxcbiAgICBlcnJvclRleHQ6IHRoaXMucHJvcHMuZXJyb3IgfHwgZmFsc2UsXG4gIH07XG5cbiAgaW5wdXRGaWxlID0gUmVhY3QuY3JlYXRlUmVmKCk7XG5cbiAgb25DaGFuZ2VIYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgeyBoYXNQcmV2aWV3LCBhbGxvd2VkRXh0ZW5zaW9ucyB9ID0gdGhpcy5wcm9wcy5maWVsZDtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGltYWdlUHJldmlld1VybDogbnVsbCxcbiAgICAgIHNlbGVjdGVkRmlsZTogZXZlbnQudGFyZ2V0LmZpbGVzWzBdLFxuICAgICAgdXBsb2FkRmlsZVRleHQ6IGV2ZW50LnRhcmdldC5maWxlc1swXSA/IGV2ZW50LnRhcmdldC5maWxlc1swXS5uYW1lIDogJ05vIGZpbGUgY2hvc2VuJyxcbiAgICB9KTtcblxuICAgIGlmIChoYXNQcmV2aWV3ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuZmlsZXNbMF0pIHtcbiAgICAgIC8vIGNoZWNrIGZpbGUgdHlwZVxuICAgICAgY29uc3QgZXh0ZW5zaW9uID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdLm5hbWVcbiAgICAgICAgLnNwbGl0KCcuJylcbiAgICAgICAgLnBvcCgpXG4gICAgICAgIC50b0xvd2VyQ2FzZSgpOyAvLyBmaWxlIGV4dGVuc2lvbiBmcm9tIGlucHV0IGZpbGVcbiAgICAgIGNvbnN0IGlzU3VjY2VzcyA9IGFsbG93ZWRFeHRlbnNpb25zLmluZGV4T2YoZXh0ZW5zaW9uKSA+IC0xOyAvLyBpcyBleHRlbnNpb24gaW4gYWNjZXB0YWJsZSB0eXBlc1xuICAgICAgaWYgKGlzU3VjY2Vzcykge1xuICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgIHJlYWRlci5vbmxvYWRlbmQgPSAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpbWFnZVByZXZpZXdVcmw6IHJlYWRlci5yZXN1bHQsXG4gICAgICAgICAgICBwcmV2aWV3SUQ6IGZhbHNlLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGV2ZW50LnRhcmdldC5maWxlc1swXSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJlbW92ZUZpbGVQcmV2aWV3ID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgZmllbGQsIHVuc2V0RXJyb3IgfSA9IHRoaXMucHJvcHM7XG4gICAgdGhpcy5pbnB1dEZpbGUuY3VycmVudC52YWx1ZSA9ICcnO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBpbWFnZVByZXZpZXdVcmw6IG51bGwsIHNlbGVjdGVkRmlsZTogbnVsbCwgcHJldmlld0lEOiBmYWxzZSB9KTtcbiAgICB1bnNldEVycm9yKGZpZWxkLmlkKTtcbiAgfTtcblxuICBwcmVwYXJlQWxsb3dlZFR5cGVzID0gKHR5cGVzKSA9PiB7XG4gICAgbGV0IGFjY2VwdCA9IHR5cGVzLnNwbGl0KCcsJyk7XG4gICAgYWNjZXB0ID0gYWNjZXB0Lm1hcCgoc3RyKSA9PiBgLiR7c3RyLnJlcGxhY2UoL1xccy9nLCAnJyl9YCkuam9pbignLCAnKTtcbiAgICByZXR1cm4gYWNjZXB0O1xuICB9O1xuXG4gIG9uQnV0dG9uQ2xpY2tIYW5kbGVyID0gKCkgPT4ge1xuICAgIHRoaXMuaW5wdXRGaWxlLmN1cnJlbnQuY2xpY2soKTtcbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBzZWxlY3RlZEZpbGUsIHVwbG9hZEZpbGVUZXh0LCBpbWFnZVByZXZpZXdVcmwsIHByZXZpZXdJRCB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGZpZWxkLFxuICAgICAgdmFsdWUsXG4gICAgICB2YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIHRvdWNoZWQsXG4gICAgICBzZXRUb3VjaGVkLFxuICAgICAgaGlkZUZpZWxkLFxuICAgICAgdXBkYXRlRm9ybSxcbiAgICAgIGZvcm1JRCxcbiAgICAgIGZpZWxkRXJyb3IsXG4gICAgICBzdHlsZWRDb21wb25lbnRzLFxuICAgICAgZXJyb3IsXG4gICAgICB1bnNldEVycm9yLFxuICAgICAgZHJvcHpvbmVUZXh0LFxuICAgIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHtcbiAgICAgIGlkLFxuICAgICAgdHlwZSxcbiAgICAgIGxhYmVsLFxuICAgICAgY3NzQ2xhc3MsXG4gICAgICBpc1JlcXVpcmVkLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBkZXNjcmlwdGlvblBsYWNlbWVudCxcbiAgICAgIGxhYmVsUGxhY2VtZW50LFxuICAgICAgd2lkdGgsXG4gICAgICBhbGxvd2VkRXh0ZW5zaW9ucyxcbiAgICAgIGJ1dHRvblRleHQsXG4gICAgICBoYXNQcmV2aWV3LFxuICAgICAgbWF4RmlsZVNpemUsXG4gICAgfSA9IGZpZWxkO1xuICAgIGNvbnN0IHsgQnV0dG9uID0gJ2J1dHRvbicsIExhYmVsID0gJ2xhYmVsJywgRmlsZVdyYXBwZXIgPSAnZGl2JywgQm94ID0gJ2RpdicgfSA9XG4gICAgICBzdHlsZWRDb21wb25lbnRzIHx8IGZhbHNlO1xuXG4gICAgY29uc3QgaGFzRHJvcHpvbmUgPSBjc3NDbGFzcy5pbmRleE9mKCdkcm9wem9uZScpID4gLTE7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPEJveFxuICAgICAgICB3aWR0aD17d2lkdGh9XG4gICAgICAgIGNsYXNzTmFtZT17XG4gICAgICAgICAgKHZhbGlkYXRpb25NZXNzYWdlICYmIHRvdWNoZWQpIHx8IGVycm9yXG4gICAgICAgICAgICA/IGBmb3JtLWZpZWxkIGVycm9yICR7Y3NzQ2xhc3N9YFxuICAgICAgICAgICAgOiBgZm9ybS1maWVsZCAke2Nzc0NsYXNzfWBcbiAgICAgICAgfVxuICAgICAgICBzdHlsZT17eyBkaXNwbGF5OiBoaWRlRmllbGQgPyAnbm9uZScgOiB1bmRlZmluZWQgfX1cbiAgICAgID5cbiAgICAgICAgPEZpbGVXcmFwcGVyIGNsYXNzTmFtZT17dHlwZX0+XG4gICAgICAgICAgPElucHV0TGFiZWxcbiAgICAgICAgICAgIGZvcm1JZD17Zm9ybUlEfVxuICAgICAgICAgICAgaWQ9e2lkfVxuICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgbGFiZWxQbGFjZW1lbnQ9e2xhYmVsUGxhY2VtZW50fVxuICAgICAgICAgICAgaXNSZXF1aXJlZD17aXNSZXF1aXJlZH1cbiAgICAgICAgICAgIHN0eWxlZENvbXBvbmVudD17c3R5bGVkQ29tcG9uZW50c31cbiAgICAgICAgICAvPlxuICAgICAgICAgIHtkZXNjcmlwdGlvblBsYWNlbWVudCA9PT0gJ2Fib3ZlJyAmJiBkZXNjcmlwdGlvbiA/IChcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uICYmIDxkaXYgY2xhc3NOYW1lPVwiZGVzY3JpcHRpb25cIj57ZGVzY3JpcHRpb259PC9kaXY+XG4gICAgICAgICAgKSA6IGhhc0Ryb3B6b25lID8gKFxuICAgICAgICAgICAgPEdGRHJvcHpvbmVcbiAgICAgICAgICAgICAgZHJvcHpvbmVUZXh0PXtkcm9wem9uZVRleHR9XG4gICAgICAgICAgICAgIGZpZWxkPXtmaWVsZH1cbiAgICAgICAgICAgICAgaWQ9e2lkfVxuICAgICAgICAgICAgICBmb3JtSUQ9e2Zvcm1JRH1cbiAgICAgICAgICAgICAgaXNSZXF1aXJlZD17aXNSZXF1aXJlZH1cbiAgICAgICAgICAgICAgdXBkYXRlRm9ybT17dXBkYXRlRm9ybX1cbiAgICAgICAgICAgICAgc2V0VG91Y2hlZD17c2V0VG91Y2hlZH1cbiAgICAgICAgICAgICAgdW5zZXRFcnJvcj17dW5zZXRFcnJvcn1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxSZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICAgICAge21heEZpbGVTaXplICYmIChcbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJNQVhfRklMRV9TSVpFXCIgdmFsdWU9e21heEZpbGVTaXplICogMTA0ODU3Nn0gLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgaWQ9e2BpbnB1dF8ke2Zvcm1JRH1fJHtpZH1gfVxuICAgICAgICAgICAgICAgIG5hbWU9e2BpbnB1dF8ke2lkfWB9XG4gICAgICAgICAgICAgICAgdHlwZT1cImZpbGVcIlxuICAgICAgICAgICAgICAgIHJlcXVpcmVkPXtpc1JlcXVpcmVkfVxuICAgICAgICAgICAgICAgIHJlZj17dGhpcy5pbnB1dEZpbGV9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUhhbmRsZXIoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgdXBkYXRlRm9ybShldmVudCwgZmllbGQpO1xuICAgICAgICAgICAgICAgICAgc2V0VG91Y2hlZChpZCk7XG4gICAgICAgICAgICAgICAgICB1bnNldEVycm9yKGlkKTtcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIG9uQmx1cj17KGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICB1cGRhdGVGb3JtKGV2ZW50LCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgICBzZXRUb3VjaGVkKGlkKTtcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIGFjY2VwdD17dGhpcy5wcmVwYXJlQWxsb3dlZFR5cGVzKGFsbG93ZWRFeHRlbnNpb25zKSB8fCB1bmRlZmluZWR9XG4gICAgICAgICAgICAgICAgYXJpYS1sYWJlbD17bGFiZWx9XG4gICAgICAgICAgICAgICAgYXJpYS1kZXNjcmliZWRieT17YGVycm9yXyR7Zm9ybUlEfV8ke2lkfWB9XG4gICAgICAgICAgICAgICAgYXJpYS1pbnZhbGlkPXshIXZhbGlkYXRpb25NZXNzYWdlIHx8ICEhZXJyb3J9XG4gICAgICAgICAgICAgICAgaGlkZGVuPVwiaGlkZGVuXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAge3ByZXZpZXdJRCAmJiBmaWVsZC5wcmV2aWV3ICYmIChcbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJmaWxlLXVwbG9hZC1wcmV2aWV3XCIgdmFsdWU9e3ByZXZpZXdJRH0gLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAge2hhc1ByZXZpZXcgJiYgKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZpbGUtcHJldmlld1wiXG4gICAgICAgICAgICAgICAgICBzdHlsZT17XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZSAmJiBpbWFnZVByZXZpZXdVcmxcbiAgICAgICAgICAgICAgICAgICAgICA/IHsgYmFja2dyb3VuZEltYWdlOiBgdXJsKCR7aW1hZ2VQcmV2aWV3VXJsfSlgIH1cbiAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHtzZWxlY3RlZEZpbGUgJiYgaW1hZ2VQcmV2aWV3VXJsICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInJlbW92ZS1maWxlXCJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLnJlbW92ZUZpbGVQcmV2aWV3KCl9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgYXJpYS1wcmVzc2VkPVwiZmFsc2VcIlxuICAgICAgICAgICAgICAgIHRhYkluZGV4PVwiMFwiXG4gICAgICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmlsZVVwbG9hZFwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkJ1dHRvbkNsaWNrSGFuZGxlcn1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxCdXR0b24gY29sb3I9XCJ5ZWxsb3dcIiB0YWJJbmRleD1cIi0xXCIgdHlwZT1cImJ1dHRvblwiPlxuICAgICAgICAgICAgICAgICAge2J1dHRvblRleHQgfHwgJ0Nob29zZSBhIGZpbGUnfVxuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDxzcGFuPnt1cGxvYWRGaWxlVGV4dH08L3NwYW4+XG4gICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgIHtkZXNjcmlwdGlvbiAmJiA8ZGl2IGNsYXNzTmFtZT1cImRlc2NyaXB0aW9uXCI+e2Rlc2NyaXB0aW9ufTwvZGl2Pn1cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7KCh2YWxpZGF0aW9uTWVzc2FnZSAmJiB0b3VjaGVkKSB8fCBlcnJvcikgJiYgKFxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZXJyb3ItbWVzc2FnZVwiIGlkPXtgZXJyb3JfJHtpZH1gfT5cbiAgICAgICAgICAgICAge3ZhbGlkYXRpb25NZXNzYWdlIHx8IGVycm9yfVxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICl9XG4gICAgICAgICAge2ZpZWxkRXJyb3IgJiYgKFxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZXJyb3ItbWVzc2FnZVwiIGlkPXtgZXJyb3JfJHtmb3JtSUR9XyR7aWR9YH0+XG4gICAgICAgICAgICAgIHtmaWVsZEVycm9yfVxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRmlsZVdyYXBwZXI+XG4gICAgICA8L0JveD5cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZpbGV1cGxvYWQ7XG5cbiJdfQ==
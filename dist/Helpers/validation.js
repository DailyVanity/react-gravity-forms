"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateField=exports.selectValidation=exports.isUrl=exports.isRequired=exports.isEmpty=exports.isEmail=exports.checkboxValidation=void 0;const getMessage=(a,b)=>!!b&&(a&&"object"==typeof a&&a.custom?a.custom:a&&"object"==typeof a&&a[b]?a[b]:a),isEmail=(a,b,c)=>{if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)){const a=getMessage(c,"email");return a||"Enter a valid email"}return!1};exports.isEmail=isEmail;const isUrl=(a,b,c)=>{if(!/^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3}))(\:\d+)?(\/[-a-z\d%_.~+]*)*(\?[;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/i.test(a)){const a=getMessage(c,"url");return a||"Enter a valid url"}return!1};exports.isUrl=isUrl;const isEmpty=a=>!a;exports.isEmpty=isEmpty;const isRequired=(a,b,c)=>{if(a&&b){const a=getMessage(c,"required");return a||"This field is required"}return!1};exports.isRequired=isRequired;const selectValidation=(a,b,c)=>!(b===c&&a);exports.selectValidation=selectValidation;const checkboxValidation=(a,b)=>!!(1>a.length)&&(b||"This field is required");exports.checkboxValidation=checkboxValidation;const emailValidation=(a,b)=>{const{inputs:c,isRequired:d,errorMessage:e}=b||!1,{required:f,mismatch:g}=e||!1,h=a&&a.filter(a=>a&&""===a.val).length;if((a&&2>a.length||0!==h)&&d)return f||"This field is required";if(a&&0<a.length)for(let b=0;a.length>b;b++){const c=isEmail(a[b].val);if(c)return c}return!!(a&&2===a.length&&c&&2===c.length&&a[1]&&a[0]&&""!==a[1].val&&a[1].val!==a[0].val)&&(g||"Mismatch")},passwordValidation=(a,b)=>{const{inputs:c,isRequired:d,errorMessage:e}=b||!1,{required:f,mismatch:g}=e||!1,h=c.filter(a=>!a.isHidden),i=a&&a.filter(a=>a&&""===a.val).length;return(a&&0===a.length||i===h.length)&&d?f||"This field is required":!!(a&&2===a.length&&h&&2===h.length&&a[1]&&a[0]&&""!==a[1].val&&a[1].val!==a[0].val)&&(g||"Mismatch")},isPostcode=(a,b,c)=>{if(!/^[1-9][0-9]{3} ?(?!sa|sd|ss)[a-z]{2}$/i.test(a)){const a=getMessage(c,"email");return a||"Enter a valid postcode"}return!1},isDate=(a,b)=>{const c=[];for(let d=0;d<a.length;d++)if(a[d]){const{val:e,label:f}=a[d];if(e)if("MM"===f){const a=b.errorMessage.month;(e.length>2||e<1||e>12)&&(c[d]={index:d,message:getMessage(a,"date")||"Enter a valid month"})}else if("DD"===f){const a=b.errorMessage.date;(e.length>2||e<1||e>31)&&(c[d]={index:d,message:getMessage(a,"date")||"Enter a valid date"})}else if("YYYY"===f){const a=b.errorMessage.year,f=new Date().getFullYear()+1;(e.length>4||e<1920||e>f)&&(c[d]={index:d,message:getMessage(a,"date")||"Enter a valid year"})}}return c},validateField=(a,b)=>{const{type:c,isRequired:d}=b;if(("checkbox"===c||"radio"===c)&&d)return checkboxValidation(a,b.errorMessage);if("password"===c)return passwordValidation(a,b);if("email"===c&&b.emailConfirmEnabled)return emailValidation(a,b);const e=isEmpty(a);let f="";const g=!!(b&&b.errorMessage)&&b.errorMessage;if(f=!!d&&isRequired(d,e,g),!f&&!e)if("email"===c)f=isEmail(a,b,g);else if("website"===c)f=isUrl(a,b,g);else if("date"===c){let c=!0;c=b.dateType&&"datepicker"===b.dateType?!!d&&isRequired(d,e,g):isDate(a,b),f=!!(0<c.length)&&c}else"postcode"===c&&(f=isPostcode(a,b,g));return f};exports.validateField=validateField;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRNZXNzYWdlIiwibWVzc2FnZSIsInR5cGUiLCJjdXN0b20iLCJpc0VtYWlsIiwiZW1haWwiLCJmaWVsZCIsInRlc3QiLCJjdXN0b21NZXNzYWdlIiwiZXhwb3J0cyIsImlzVXJsIiwic3RyIiwiaXNFbXB0eSIsInZhbHVlIiwiaXNSZXF1aXJlZCIsInJlcXVpcmVkIiwiZW1wdHkiLCJzZWxlY3RWYWxpZGF0aW9uIiwicGxhY2Vob2xkZXIiLCJjaGVja2JveFZhbGlkYXRpb24iLCJ2YWx1ZXMiLCJsZW5ndGgiLCJlbWFpbFZhbGlkYXRpb24iLCJpbnB1dHMiLCJlcnJvck1lc3NhZ2UiLCJyZXF1aXJlZE1zZyIsIm1pc21hdGNoIiwiaXNJbnB1dHNFbXB0eSIsImZpbHRlciIsIml0ZW0iLCJ2YWwiLCJpIiwiaXNJblZhbGlkTWFpbCIsInBhc3N3b3JkVmFsaWRhdGlvbiIsImZpbHRlcmVkSW5wdXRzIiwiaXNIaWRkZW4iLCJpc1Bvc3Rjb2RlIiwicG9zdGNvZGUiLCJpc0RhdGUiLCJ2YWxpZGF0aW9uIiwibGFiZWwiLCJtb250aCIsImluZGV4IiwiZGF0ZSIsInllYXIiLCJtYXgiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJ2YWxpZGF0ZUZpZWxkIiwiZW1haWxDb25maXJtRW5hYmxlZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiaXNWYWxpZCIsImRhdGVUeXBlIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL0hlbHBlcnMvdmFsaWRhdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnZXRNZXNzYWdlID0gKG1lc3NhZ2UsIHR5cGUpID0+IHtcbiAgaWYgKCF0eXBlKSByZXR1cm4gZmFsc2U7XG5cblxuICBpZiAobWVzc2FnZSAmJiB0eXBlb2YgbWVzc2FnZSA9PT0gJ29iamVjdCcgJiYgbWVzc2FnZS5jdXN0b20pIHtcbiAgICByZXR1cm4gbWVzc2FnZS5jdXN0b207XG4gIH1cblxuICBpZiAobWVzc2FnZSAmJiB0eXBlb2YgbWVzc2FnZSA9PT0gJ29iamVjdCcgJiYgbWVzc2FnZVt0eXBlXSkge1xuICAgIHJldHVybiBtZXNzYWdlW3R5cGVdO1xuICB9XG5cbiAgcmV0dXJuIG1lc3NhZ2U7XG59O1xuXG5jb25zdCBpc0VtYWlsID0gKGVtYWlsLCBmaWVsZCwgbWVzc2FnZSkgPT4ge1xuICBjb25zdCByZSA9IC9eKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfV0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xuXG4gIGlmICghcmUudGVzdChlbWFpbCkpIHtcbiAgICBjb25zdCBjdXN0b21NZXNzYWdlID0gZ2V0TWVzc2FnZShtZXNzYWdlLCAnZW1haWwnKTtcbiAgICByZXR1cm4gY3VzdG9tTWVzc2FnZSB8fCBcIkVudGVyIGEgdmFsaWQgZW1haWxcIjtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5jb25zdCBpc1VybCA9IChzdHIsIGZpZWxkLCBtZXNzYWdlKSA9PiB7XG4gIGNvbnN0IHBhdHRlcm4gPSBuZXcgUmVnRXhwKFxuICAgICdeKGh0dHBzPzpcXFxcL1xcXFwvKT8nIC8vIHByb3RvY29sXG4gICAgKyAnKCgoW2EtelxcXFxkXShbYS16XFxcXGQtXSpbYS16XFxcXGRdKSopXFxcXC4pK1thLXpdezIsfXwnIC8vIGRvbWFpbiBuYW1lXG4gICAgKyAnKChcXFxcZHsxLDN9XFxcXC4pezN9XFxcXGR7MSwzfSkpJyAvLyBPUiBpcCAodjQpIGFkZHJlc3NcbiAgICArICcoXFxcXDpcXFxcZCspPyhcXFxcL1stYS16XFxcXGQlXy5+K10qKSonIC8vIHBvcnQgYW5kIHBhdGhcbiAgICArICcoXFxcXD9bOyZhLXpcXFxcZCVfLn4rPS1dKik/JyAvLyBxdWVyeSBzdHJpbmdcbiAgICArICcoXFxcXCNbLWEtelxcXFxkX10qKT8kJyxcbiAgICAnaScsXG4gICk7IC8vIGZyYWdtZW50IGxvY2F0b3JcbiAgaWYgKCFwYXR0ZXJuLnRlc3Qoc3RyKSkge1xuICAgIGNvbnN0IGN1c3RvbU1lc3NhZ2UgPSBnZXRNZXNzYWdlKG1lc3NhZ2UsICd1cmwnKTtcbiAgICByZXR1cm4gY3VzdG9tTWVzc2FnZSB8fCBcIkVudGVyIGEgdmFsaWQgdXJsXCI7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuY29uc3QgaXNFbXB0eSA9ICh2YWx1ZSkgPT4ge1xuICBpZiAoIXZhbHVlKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuY29uc3QgaXNSZXF1aXJlZCA9IChyZXF1aXJlZCwgZW1wdHksIG1lc3NhZ2UpID0+IHtcbiAgaWYgKHJlcXVpcmVkICYmIGVtcHR5KSB7XG4gICAgY29uc3QgY3VzdG9tTWVzc2FnZSA9IGdldE1lc3NhZ2UobWVzc2FnZSwgJ3JlcXVpcmVkJyk7XG4gICAgcmV0dXJuIGN1c3RvbU1lc3NhZ2UgfHwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbmNvbnN0IHNlbGVjdFZhbGlkYXRpb24gPSAocmVxdWlyZWQsIHZhbHVlLCBwbGFjZWhvbGRlcikgPT4gISh2YWx1ZSA9PT0gcGxhY2Vob2xkZXIgJiYgcmVxdWlyZWQpO1xuXG5jb25zdCBjaGVja2JveFZhbGlkYXRpb24gPSAodmFsdWVzLCBtZXNzYWdlKSA9PiB7XG4gIGlmICh2YWx1ZXMubGVuZ3RoIDwgMSkge1xuICAgIHJldHVybiBtZXNzYWdlIHx8ICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJztcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5jb25zdCBlbWFpbFZhbGlkYXRpb24gPSAodmFsdWVzLCBmaWVsZCkgPT4ge1xuICBjb25zdCB7IGlucHV0cywgaXNSZXF1aXJlZDogcmVxdWlyZWQsIGVycm9yTWVzc2FnZSB9ID0gZmllbGQgfHwgZmFsc2U7XG4gIGNvbnN0IHsgcmVxdWlyZWQ6IHJlcXVpcmVkTXNnLCBtaXNtYXRjaCB9ID0gZXJyb3JNZXNzYWdlIHx8IGZhbHNlO1xuXG4gIC8vIGNoZWNrIGlmIGZpZWxkcyBpcyByZXF1aXJlZCBhbmQgaXNuJ3QgZW1wdHlcbiAgY29uc3QgaXNJbnB1dHNFbXB0eSA9IHZhbHVlcyAmJiB2YWx1ZXMuZmlsdGVyKGl0ZW0gPT4gaXRlbSAmJiBpdGVtLnZhbCA9PT0gJycpLmxlbmd0aDtcblxuICBpZiAoKCh2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA8IDIpIHx8IGlzSW5wdXRzRW1wdHkgIT09IDApICYmIHJlcXVpcmVkKSB7XG4gICAgcmV0dXJuIHJlcXVpcmVkTXNnIHx8ICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJztcbiAgfVxuXG4gIGlmICh2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICBmb3IgKGxldCBpID0gMDsgdmFsdWVzLmxlbmd0aCA+IGk7IGkrKykge1xuICAgICAgY29uc3QgaXNJblZhbGlkTWFpbCA9IGlzRW1haWwodmFsdWVzW2ldLnZhbCk7XG4gICAgICBpZiAoaXNJblZhbGlkTWFpbCkge1xuICAgICAgICByZXR1cm4gaXNJblZhbGlkTWFpbDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBpZiB0aGVyZSBpcyByZXBlYXQgcGFzc3dvcmQgZmllbGQgPT4gY2hlY2sgaWYgbWF0Y2hcbiAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID09PSAyICYmIGlucHV0cyAmJiBpbnB1dHMubGVuZ3RoID09PSAyKSB7XG4gICAgaWYgKFxuICAgICAgdmFsdWVzWzFdXG4gICAgICAmJiB2YWx1ZXNbMF1cbiAgICAgICYmIHZhbHVlc1sxXS52YWwgIT09ICcnXG4gICAgICAmJiB2YWx1ZXNbMV0udmFsICE9PSB2YWx1ZXNbMF0udmFsXG4gICAgKSB7XG4gICAgICByZXR1cm4gbWlzbWF0Y2ggfHwgJ01pc21hdGNoJztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5jb25zdCBwYXNzd29yZFZhbGlkYXRpb24gPSAodmFsdWVzLCBmaWVsZCkgPT4ge1xuICBjb25zdCB7IGlucHV0cywgaXNSZXF1aXJlZDogcmVxdWlyZWQsIGVycm9yTWVzc2FnZSB9ID0gZmllbGQgfHwgZmFsc2U7XG4gIGNvbnN0IHsgcmVxdWlyZWQ6IHJlcXVpcmVkTXNnLCBtaXNtYXRjaCB9ID0gZXJyb3JNZXNzYWdlIHx8IGZhbHNlO1xuXG4gIGNvbnN0IGZpbHRlcmVkSW5wdXRzID0gaW5wdXRzLmZpbHRlcihpdGVtID0+ICFpdGVtLmlzSGlkZGVuKTtcblxuICAvLyBjaGVjayBpZiBmaWVsZHMgaXMgcmVxdWlyZWQgYW5kIGlzbid0IGVtcHR5XG4gIGNvbnN0IGlzSW5wdXRzRW1wdHkgPSB2YWx1ZXMgJiYgdmFsdWVzLmZpbHRlcihpdGVtID0+IGl0ZW0gJiYgaXRlbS52YWwgPT09ICcnKS5sZW5ndGg7XG5cbiAgaWYgKFxuICAgICgodmFsdWVzICYmIHZhbHVlcy5sZW5ndGggPT09IDApXG4gICAgICB8fCBpc0lucHV0c0VtcHR5ID09PSBmaWx0ZXJlZElucHV0cy5sZW5ndGgpXG4gICAgJiYgcmVxdWlyZWRcbiAgKSB7XG4gICAgcmV0dXJuIHJlcXVpcmVkTXNnIHx8ICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJztcbiAgfVxuXG4gIC8vIGlmIHRoZXJlIGlzIHJlcGVhdCBwYXNzd29yZCBmaWVsZCA9PiBjaGVjayBpZiBtYXRjaFxuICBpZiAoXG4gICAgdmFsdWVzXG4gICAgJiYgdmFsdWVzLmxlbmd0aCA9PT0gMlxuICAgICYmIGZpbHRlcmVkSW5wdXRzXG4gICAgJiYgZmlsdGVyZWRJbnB1dHMubGVuZ3RoID09PSAyXG4gICkge1xuICAgIGlmIChcbiAgICAgIHZhbHVlc1sxXVxuICAgICAgJiYgdmFsdWVzWzBdXG4gICAgICAmJiB2YWx1ZXNbMV0udmFsICE9PSAnJ1xuICAgICAgJiYgdmFsdWVzWzFdLnZhbCAhPT0gdmFsdWVzWzBdLnZhbFxuICAgICkge1xuICAgICAgcmV0dXJuIG1pc21hdGNoIHx8ICdNaXNtYXRjaCc7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuY29uc3QgaXNQb3N0Y29kZSA9IChwb3N0Y29kZSwgZmllbGQsIG1lc3NhZ2UpID0+IHtcbiAgY29uc3QgcmUgPSAvXlsxLTldWzAtOV17M30gPyg/IXNhfHNkfHNzKVthLXpdezJ9JC9pO1xuXG4gICAgaWYgKCFyZS50ZXN0KHBvc3Rjb2RlKSkge1xuICAgIGNvbnN0IGN1c3RvbU1lc3NhZ2UgPSBnZXRNZXNzYWdlKG1lc3NhZ2UsICdlbWFpbCcpO1xuICAgIHJldHVybiBjdXN0b21NZXNzYWdlIHx8IFwiRW50ZXIgYSB2YWxpZCBwb3N0Y29kZVwiO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbmNvbnN0IGlzRGF0ZSA9ICh2YWx1ZXMsIGZpZWxkKSA9PiB7XG4gIGNvbnN0IHZhbGlkYXRpb24gPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAodmFsdWVzW2ldKSB7XG4gICAgICBjb25zdCB7IHZhbCwgbGFiZWwgfSA9IHZhbHVlc1tpXTtcbiAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgaWYgKGxhYmVsID09PSAnTU0nKSB7XG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGZpZWxkLmVycm9yTWVzc2FnZVsnbW9udGgnXTtcbiAgICAgICAgICBjb25zdCBtYXggPSAxMjtcbiAgICAgICAgICBjb25zdCBtaW4gPSAxO1xuICAgICAgICAgIGNvbnN0IG1heExlbmd0aCA9IDI7XG4gICAgICAgICAgaWYgKHZhbC5sZW5ndGggPiBtYXhMZW5ndGggfHwgdmFsIDwgbWluIHx8IHZhbCA+IG1heCkge1xuICAgICAgICAgICAgdmFsaWRhdGlvbltpXSA9IHtcbiAgICAgICAgICAgICAgaW5kZXg6IGksXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGdldE1lc3NhZ2UobWVzc2FnZSwgJ2RhdGUnKSB8fCBcIkVudGVyIGEgdmFsaWQgbW9udGhcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGxhYmVsID09PSAnREQnKSB7XG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGZpZWxkLmVycm9yTWVzc2FnZVsnZGF0ZSddO1xuICAgICAgICAgIGNvbnN0IG1heCA9IDMxO1xuICAgICAgICAgIGNvbnN0IG1pbiA9IDE7XG4gICAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gMjtcbiAgICAgICAgICBpZiAodmFsLmxlbmd0aCA+IG1heExlbmd0aCB8fCB2YWwgPCBtaW4gfHwgdmFsID4gbWF4KSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uW2ldID0ge1xuICAgICAgICAgICAgICBpbmRleDogaSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogZ2V0TWVzc2FnZShtZXNzYWdlLCAnZGF0ZScpIHx8IFwiRW50ZXIgYSB2YWxpZCBkYXRlXCIsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChsYWJlbCA9PT0gJ1lZWVknKSB7XG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGZpZWxkLmVycm9yTWVzc2FnZVsneWVhciddO1xuICAgICAgICAgIGNvbnN0IG1heCA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSArIDE7XG4gICAgICAgICAgY29uc3QgbWluID0gMTkyMDtcbiAgICAgICAgICBjb25zdCBtYXhMZW5ndGggPSA0O1xuICAgICAgICAgIGlmICh2YWwubGVuZ3RoID4gbWF4TGVuZ3RoIHx8IHZhbCA8IG1pbiB8fCB2YWwgPiBtYXgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRpb25baV0gPSB7XG4gICAgICAgICAgICAgIGluZGV4OiBpLFxuICAgICAgICAgICAgICBtZXNzYWdlOiBnZXRNZXNzYWdlKG1lc3NhZ2UsICdkYXRlJykgfHwgXCJFbnRlciBhIHZhbGlkIHllYXJcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB2YWxpZGF0aW9uO1xufTtcblxuY29uc3QgdmFsaWRhdGVGaWVsZCA9ICh2YWx1ZSwgZmllbGQpID0+IHtcbiAgY29uc3QgeyB0eXBlLCBpc1JlcXVpcmVkOiByZXF1aXJlZCB9ID0gZmllbGQ7XG4gIC8vIENoZWNrIGZpcnN0IGlmIHJlcXVyaWVkIGNoZWNrYm94IG9yIHJhZGlvXG4gIGlmICgodHlwZSA9PT0gJ2NoZWNrYm94JyB8fCB0eXBlID09PSAncmFkaW8nKSAmJiByZXF1aXJlZCkge1xuICAgIHJldHVybiBjaGVja2JveFZhbGlkYXRpb24odmFsdWUsIGZpZWxkLmVycm9yTWVzc2FnZSk7XG4gIH1cblxuICBpZiAodHlwZSA9PT0gJ3Bhc3N3b3JkJykge1xuICAgIHJldHVybiBwYXNzd29yZFZhbGlkYXRpb24odmFsdWUsIGZpZWxkKTtcbiAgfVxuXG4gIGlmICh0eXBlID09PSAnZW1haWwnICYmIGZpZWxkLmVtYWlsQ29uZmlybUVuYWJsZWQpIHtcbiAgICByZXR1cm4gZW1haWxWYWxpZGF0aW9uKHZhbHVlLCBmaWVsZCk7XG4gIH1cblxuICAvLyBDaGVjayBpZiBlbXB0eVxuICBjb25zdCBlbXB0eSA9IGlzRW1wdHkodmFsdWUpO1xuICBsZXQgdmFsaWRhdGlvbk1lc3NhZ2UgPSAnJztcbiAgY29uc3QgbWVzc2FnZSA9IGZpZWxkICYmIGZpZWxkLmVycm9yTWVzc2FnZSA/IGZpZWxkLmVycm9yTWVzc2FnZSA6IGZhbHNlO1xuICAvLyBTZXQgdmFsaWRhdGlvbiBtZXNzYWdlIGlmIHJlcXVpcmVkXG4gIHZhbGlkYXRpb25NZXNzYWdlID0gcmVxdWlyZWQgPyBpc1JlcXVpcmVkKHJlcXVpcmVkLCBlbXB0eSwgbWVzc2FnZSkgOiBmYWxzZTtcbiAgLy8gU2V0IG90aGVyIHZhbGlkYXRpb24gbWVzc2FnZXNcbiAgaWYgKCF2YWxpZGF0aW9uTWVzc2FnZSAmJiAhZW1wdHkpIHtcbiAgICBpZiAodHlwZSA9PT0gJ2VtYWlsJykge1xuICAgICAgdmFsaWRhdGlvbk1lc3NhZ2UgPSBpc0VtYWlsKHZhbHVlLCBmaWVsZCwgbWVzc2FnZSk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnd2Vic2l0ZScpIHtcbiAgICAgIHZhbGlkYXRpb25NZXNzYWdlID0gaXNVcmwodmFsdWUsIGZpZWxkLCBtZXNzYWdlKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdkYXRlJykge1xuICAgICAgbGV0IGlzVmFsaWQgPSB0cnVlO1xuICAgICAgaWYgKGZpZWxkLmRhdGVUeXBlICYmIGZpZWxkLmRhdGVUeXBlID09PSAnZGF0ZXBpY2tlcicpIHtcbiAgICAgICAgaXNWYWxpZCA9IHJlcXVpcmVkID8gaXNSZXF1aXJlZChyZXF1aXJlZCwgZW1wdHksIG1lc3NhZ2UpIDogZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpc1ZhbGlkID0gaXNEYXRlKHZhbHVlLCBmaWVsZCk7XG4gICAgICB9XG4gICAgICB2YWxpZGF0aW9uTWVzc2FnZSA9IGlzVmFsaWQubGVuZ3RoID4gMCA/IGlzVmFsaWQgOiBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdwb3N0Y29kZScpIHtcbiAgICAgIHZhbGlkYXRpb25NZXNzYWdlID0gaXNQb3N0Y29kZSh2YWx1ZSwgZmllbGQsIG1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdmFsaWRhdGlvbk1lc3NhZ2U7XG59O1xuXG5leHBvcnQge1xuICBpc0VtcHR5LFxuICBzZWxlY3RWYWxpZGF0aW9uLFxuICBjaGVja2JveFZhbGlkYXRpb24sXG4gIGlzVXJsLFxuICBpc0VtYWlsLFxuICBpc1JlcXVpcmVkLFxuICB2YWxpZGF0ZUZpZWxkLFxufTtcbiJdLCJtYXBwaW5ncyI6IjJOQUFNLENBQUFBLFVBQVUsQ0FBR0EsQ0FBQ0MsQ0FBTyxDQUFFQyxDQUFJLEtBQzFCQSxDQUFJLEdBR0xELENBQU8sRUFBdUIsUUFBUSxFQUEzQixNQUFPLENBQUFBLENBQW9CLEVBQUlBLENBQU8sQ0FBQ0UsTUFBTSxDQUNuREYsQ0FB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
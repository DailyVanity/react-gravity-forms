"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=_interopRequireWildcard(require("react")),FormFields=_interopRequireWildcard(require("../Fields"));function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return _getRequireWildcardCache=function(){return a},a}function _interopRequireWildcard(a){if(a&&a.__esModule)return a;if(null===a||"object"!==_typeof(a)&&"function"!=typeof a)return{default:a};var b=_getRequireWildcardCache();if(b&&b.has(a))return b.get(a);var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a)if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;f&&(f.get||f.set)?Object.defineProperty(c,e,f):c[e]=a[e]}return c["default"]=a,b&&b.set(a,c),c}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}var frac2dec=function(a){var b=a.split("-");if(1===b.length&&(b=a.split(" ")),1<b.length&&-1!==a.indexOf("/")){var c=parseInt(b[0]),d=b[1].split("/"),e=parseInt(d[0])/parseInt(d[1]);return c+e}if(-1!==a.indexOf("/")){var f=a.split("/"),g=parseInt(f[0])/parseInt(f[1]);return g}return parseInt(a)},formatComponentName=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},formatWidthFromCss=function(a){if(!a)return{};var b=a.indexOf("["),c=a.indexOf("]");if(-1===b||-1===c)return{};var d=a.substring(b+1,c).split(",").map(function(a){return frac2dec(a.replace(/\s/g,""))}),e="".concat(a.replace(a.substring(b,c+1),"")," custom-width");return{width:d,cleanedCssClass:e}},RenderField=function(a){var b=a.field,c=a.formValues,d=a.submitFailed,e=a.submitSuccess,f=a.setTouched,g=a.setErrorMessages,h=a.touched,i=a.updateForm,j=a.pages,k=a.prevStep,l=a.nextStep,m=a.isNextDisabled,n=a.saveStateToHtmlField,o=a.styledComponents,p=a.customComponents,q=a.error,r=a.unsetError,s=a.dropzoneText,t=a.language,u=a.apiKeys,v=FormFields[formatComponentName(b.type)];p&&(p[b.id]||p[b.cssClass])&&(v=FormFields[formatComponentName("custom")]);var w=formatWidthFromCss(b.cssClass),x=w.cleanedCssClass,y=w.width;y&&(b.cssClass=x,b.width=y);var z=c[b.id]?c[b.id].value:b.defaultValue,A=(0,_react.useState)("".concat(b.cssClass).concat("select"===b.type?z.value&&""!==z.value?" filled":"":z&&""!==z?" filled":"")),B=_slicedToArray(A,2),C=B[0],D=B[1];return _react["default"].createElement(v,{key:b.id,field:b,value:z,updateForm:function updateForm(a,b,c){return i(a,b,c)},validationMessage:!!c[b.id]&&c[b.id].valid,formValues:c,submitFailed:d,submitSuccess:e,touched:h[b.id],setTouched:f,setErrorMessages:g,unsetError:r,error:q,pages:j,prevStep:k,nextStep:l,isNextDisabled:m,hideField:!!c[b.id]&&c[b.id].hideField,saveStateToHtmlField:!("html"!==b.type||-1===b.cssClass.indexOf("set-state"))&&{formValues:c,saveStateToHtmlField:n},styledComponents:o,cssClass:C,setFocusClass:function setFocusClass(a){a?-1===C.indexOf(" filled")&&D("".concat(C," filled")):D(C.replace(" filled",""))},component:p&&(p[b.id]||p[b.cssClass]),dropzoneText:s,language:t,apiKeys:u})},_default=RenderField;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Gb3JtRWxlbWVudHMvUmVuZGVyRmllbGQuanN4Il0sIm5hbWVzIjpbImZyYWMyZGVjIiwiZnJhY3Rpb24iLCJmcmFjdGlvblBhcnRzIiwic3BsaXQiLCJsZW5ndGgiLCJpbmRleE9mIiwiaW50ZWdlciIsInBhcnNlSW50IiwiZGVjaW1hbFBhcnRzIiwiZGVjaW1hbCIsImZvcm1hdENvbXBvbmVudE5hbWUiLCJzdHJpbmciLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwiZm9ybWF0V2lkdGhGcm9tQ3NzIiwiY3NzQ2xhc3MiLCJ3aWR0aFN0YXJ0cyIsIndpZHRoRW5kcyIsIndpZHRoIiwic3Vic3RyaW5nIiwibWFwIiwiaXRlbSIsInJlcGxhY2UiLCJjbGVhbmVkQ3NzQ2xhc3MiLCJSZW5kZXJGaWVsZCIsImZpZWxkIiwiZm9ybVZhbHVlcyIsInN1Ym1pdEZhaWxlZCIsInN1Ym1pdFN1Y2Nlc3MiLCJzZXRUb3VjaGVkIiwic2V0RXJyb3JNZXNzYWdlcyIsInRvdWNoZWQiLCJ1cGRhdGVGb3JtIiwicGFnZXMiLCJwcmV2U3RlcCIsIm5leHRTdGVwIiwiaXNOZXh0RGlzYWJsZWQiLCJzYXZlU3RhdGVUb0h0bWxGaWVsZCIsInN0eWxlZENvbXBvbmVudHMiLCJjdXN0b21Db21wb25lbnRzIiwiZXJyb3IiLCJ1bnNldEVycm9yIiwiZHJvcHpvbmVUZXh0IiwibGFuZ3VhZ2UiLCJhcGlLZXlzIiwiRm9ybUNvbXBvbmVudCIsIkZvcm1GaWVsZHMiLCJ0eXBlIiwiaWQiLCJ2YWx1ZSIsImRlZmF1bHRWYWx1ZSIsImZpZWxkQ2xhc3NOYW1lIiwic2V0RmllbGRDbGFzc05hbWUiLCJldmVudCIsImlucHV0SUQiLCJ2YWxpZCIsImhpZGVGaWVsZCIsInNldEZvY3VzQ2xhc3MiLCJhY3Rpb24iXSwibWFwcGluZ3MiOiJ3dUVBR01BLENBQUFBLFFBQVEsQ0FBRyxTQUFDQyxDQUFELENBQWMsQ0FHN0IsR0FBSUMsQ0FBQUEsQ0FBYSxDQUFHRCxD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SyxDQUFDVixRQUFOLENBQWVYLE9BQWYsQ0FBdUIsV0FBdkIsQ0FEUCxHQUVkLENBQUVzQixVQUFVLENBQVZBLENBQUYsQ0FBY1csb0JBQW9CLENBQXBCQSxDQUFkLENBdkJSLENBMEJFLGdCQUFnQixDQUFFQyxDQTFCcEIsQ0EyQkUsUUFBUSxDQUFFYSxDQTNCWixDQTRCRSxhQUFhLENBdkNLLFFBQWhCTSxDQUFBQSxhQUFnQixDQUFDQyxDQUFELENBQVksQ0FDNUJBLENBRDRCLENBRVksQ0FBQyxDQUF2QyxHQUFBUCxDQUFjLENBQUMvQyxPQUFmLENBQXVCLFNBQXZCLENBRjBCLEVBRzVCZ0QsQ0FBaUIsV0FBSUQsQ0FBSixZQUhXLENBTTlCQyxDQUFpQixDQUFDRCxDQUFjLENBQUM3QixPQUFmLENBQXVCLFNBQXZCLENBQWtDLEVBQWxDLENBQUQsQ0FFcEIsQ0FHQyxDQTZCRSxTQUFTLENBQUVpQixDQUFnQixHQUFLQSxDQUFnQixDQUFDZCxDQUFLLENBQUN1QixFQUFQLENBQWhCLEVBQThCVCxDQUFnQixDQUFDZCxDQUFLLENBQUNWLFFBQVAsQ0FBbkQsQ0E3QjdCLENBOEJFLFlBQVksQ0FBRTJCLENBOUJoQixDQStCRSxRQUFRLENBQUVDLENBL0JaLENBZ0NFLE9BQU8sQ0FBRUMsQ0FoQ1gsRUFtQ0gsQyxVQUVjcEIsVyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0ICogYXMgRm9ybUZpZWxkcyBmcm9tIFwiLi4vRmllbGRzXCI7XG5cbmNvbnN0IGZyYWMyZGVjID0gKGZyYWN0aW9uKSA9PiB7XG4gIC8qIGFzc3VtZXMgZnJhY3Rpb24gaXMgaW4gdGhlIGZvcm0gIDEtMS8yIG9yIDEgMS8yICovXG4gIC8qIGRvZXNuJ3Qgd29yayBvbiBuZWdhdGl2ZSBudW1iZXJzICovXG4gIGxldCBmcmFjdGlvblBhcnRzID0gZnJhY3Rpb24uc3BsaXQoXCItXCIpO1xuICBpZiAoZnJhY3Rpb25QYXJ0cy5sZW5ndGggPT09IDEpIHtcbiAgICAvKiB0cnkgc3BhY2UgYXMgZGl2aWRlciAqL1xuICAgIGZyYWN0aW9uUGFydHMgPSBmcmFjdGlvbi5zcGxpdChcIiBcIik7XG4gIH1cblxuICBpZiAoZnJhY3Rpb25QYXJ0cy5sZW5ndGggPiAxICYmIGZyYWN0aW9uLmluZGV4T2YoXCIvXCIpICE9PSAtMSkge1xuICAgIGNvbnN0IGludGVnZXIgPSBwYXJzZUludChmcmFjdGlvblBhcnRzWzBdKTtcbiAgICBjb25zdCBkZWNpbWFsUGFydHMgPSBmcmFjdGlvblBhcnRzWzFdLnNwbGl0KFwiL1wiKTtcbiAgICBjb25zdCBkZWNpbWFsID0gcGFyc2VJbnQoZGVjaW1hbFBhcnRzWzBdKSAvIHBhcnNlSW50KGRlY2ltYWxQYXJ0c1sxXSk7XG5cbiAgICByZXR1cm4gaW50ZWdlciArIGRlY2ltYWw7XG4gIH1cbiAgaWYgKGZyYWN0aW9uLmluZGV4T2YoXCIvXCIpICE9PSAtMSkge1xuICAgIGNvbnN0IGRlY2ltYWxQYXJ0cyA9IGZyYWN0aW9uLnNwbGl0KFwiL1wiKTtcbiAgICBjb25zdCBkZWNpbWFsID0gcGFyc2VJbnQoZGVjaW1hbFBhcnRzWzBdKSAvIHBhcnNlSW50KGRlY2ltYWxQYXJ0c1sxXSk7XG4gICAgcmV0dXJuIGRlY2ltYWw7XG4gIH1cbiAgcmV0dXJuIHBhcnNlSW50KGZyYWN0aW9uKTtcbn07XG5cbmNvbnN0IGZvcm1hdENvbXBvbmVudE5hbWUgPSAoc3RyaW5nKSA9PlxuICBzdHJpbmcuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSk7XG5jb25zdCBmb3JtYXRXaWR0aEZyb21Dc3MgPSAoY3NzQ2xhc3MpID0+IHtcbiAgaWYgKCFjc3NDbGFzcykgcmV0dXJuIHt9O1xuICBjb25zdCB3aWR0aFN0YXJ0cyA9IGNzc0NsYXNzLmluZGV4T2YoXCJbXCIpO1xuICBjb25zdCB3aWR0aEVuZHMgPSBjc3NDbGFzcy5pbmRleE9mKFwiXVwiKTtcblxuICBpZiAod2lkdGhTdGFydHMgPT09IC0xIHx8IHdpZHRoRW5kcyA9PT0gLTEpIHtcbiAgICByZXR1cm4ge307XG4gIH1cblxuICBjb25zdCB3aWR0aCA9IGNzc0NsYXNzXG4gICAgLnN1YnN0cmluZyh3aWR0aFN0YXJ0cyArIDEsIHdpZHRoRW5kcylcbiAgICAuc3BsaXQoXCIsXCIpXG4gICAgLm1hcCgoaXRlbSkgPT4gZnJhYzJkZWMoaXRlbS5yZXBsYWNlKC9cXHMvZywgXCJcIikpKTtcblxuICBjb25zdCBjbGVhbmVkQ3NzQ2xhc3MgPSBgJHtjc3NDbGFzcy5yZXBsYWNlKFxuICAgIGNzc0NsYXNzLnN1YnN0cmluZyh3aWR0aFN0YXJ0cywgd2lkdGhFbmRzICsgMSksXG4gICAgXCJcIlxuICApfSBjdXN0b20td2lkdGhgO1xuXG4gIHJldHVybiB7XG4gICAgd2lkdGgsXG4gICAgY2xlYW5lZENzc0NsYXNzLFxuICB9O1xufTtcblxuY29uc3QgUmVuZGVyRmllbGQgPSAoe1xuICBmaWVsZCxcbiAgZm9ybVZhbHVlcyxcbiAgc3VibWl0RmFpbGVkLFxuICBzdWJtaXRTdWNjZXNzLFxuICBzZXRUb3VjaGVkLFxuICBzZXRFcnJvck1lc3NhZ2VzLFxuICB0b3VjaGVkLFxuICB1cGRhdGVGb3JtLFxuICBwYWdlcyxcbiAgcHJldlN0ZXAsXG4gIG5leHRTdGVwLFxuICBpc05leHREaXNhYmxlZCxcbiAgc2F2ZVN0YXRlVG9IdG1sRmllbGQsXG4gIHN0eWxlZENvbXBvbmVudHMsXG4gIGN1c3RvbUNvbXBvbmVudHMsXG4gIGVycm9yLFxuICB1bnNldEVycm9yLFxuICBkcm9wem9uZVRleHQsXG4gIGxhbmd1YWdlLFxuICBhcGlLZXlzXG59KSA9PiB7XG4gIGxldCBGb3JtQ29tcG9uZW50ID0gRm9ybUZpZWxkc1tmb3JtYXRDb21wb25lbnROYW1lKGZpZWxkLnR5cGUpXTtcblxuICBpZiAoY3VzdG9tQ29tcG9uZW50cyAmJiAoY3VzdG9tQ29tcG9uZW50c1tmaWVsZC5pZF0gfHwgY3VzdG9tQ29tcG9uZW50c1tmaWVsZC5jc3NDbGFzc10pKSB7XG4gICAgRm9ybUNvbXBvbmVudCA9IEZvcm1GaWVsZHNbZm9ybWF0Q29tcG9uZW50TmFtZSgnY3VzdG9tJyldO1xuICB9XG5cbiAgY29uc3QgeyBjbGVhbmVkQ3NzQ2xhc3MsIHdpZHRoIH0gPSBmb3JtYXRXaWR0aEZyb21Dc3MoZmllbGQuY3NzQ2xhc3MpO1xuICBpZiAod2lkdGgpIHtcbiAgICBmaWVsZC5jc3NDbGFzcyA9IGNsZWFuZWRDc3NDbGFzcztcbiAgICBmaWVsZC53aWR0aCA9IHdpZHRoO1xuICB9XG4gIGNvbnN0IHZhbHVlID0gZm9ybVZhbHVlc1tmaWVsZC5pZF1cbiAgICA/IGZvcm1WYWx1ZXNbZmllbGQuaWRdLnZhbHVlXG4gICAgOiBmaWVsZC5kZWZhdWx0VmFsdWU7XG4gIGNvbnN0IFtmaWVsZENsYXNzTmFtZSwgc2V0RmllbGRDbGFzc05hbWVdID0gdXNlU3RhdGUoXG4gICAgYCR7ZmllbGQuY3NzQ2xhc3N9JHtcbiAgICAgIGZpZWxkLnR5cGUgPT09IFwic2VsZWN0XCJcbiAgICAgICAgPyB2YWx1ZS52YWx1ZSAmJiB2YWx1ZS52YWx1ZSAhPT0gJydcbiAgICAgICAgICA/IFwiIGZpbGxlZFwiXG4gICAgICAgICAgOiBcIlwiXG4gICAgICAgIDogdmFsdWUgJiYgdmFsdWUgIT09IFwiXCJcbiAgICAgICAgPyBcIiBmaWxsZWRcIlxuICAgICAgICA6IFwiXCJcbiAgICB9YFxuICApO1xuXG4gIGNvbnN0IHNldEZvY3VzQ2xhc3MgPSAoYWN0aW9uKSA9PiB7XG4gICAgaWYgKGFjdGlvbikge1xuICAgICAgaWYgKGZpZWxkQ2xhc3NOYW1lLmluZGV4T2YoXCIgZmlsbGVkXCIpID09PSAtMSkge1xuICAgICAgICBzZXRGaWVsZENsYXNzTmFtZShgJHtmaWVsZENsYXNzTmFtZX0gZmlsbGVkYCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldEZpZWxkQ2xhc3NOYW1lKGZpZWxkQ2xhc3NOYW1lLnJlcGxhY2UoXCIgZmlsbGVkXCIsIFwiXCIpKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8Rm9ybUNvbXBvbmVudFxuICAgICAga2V5PXtmaWVsZC5pZH1cbiAgICAgIGZpZWxkPXtmaWVsZH1cbiAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgIHVwZGF0ZUZvcm09eyhldmVudCwgZmllbGQsIGlucHV0SUQpID0+IHVwZGF0ZUZvcm0oZXZlbnQsIGZpZWxkLCBpbnB1dElEKX1cbiAgICAgIHZhbGlkYXRpb25NZXNzYWdlPXtcbiAgICAgICAgZm9ybVZhbHVlc1tmaWVsZC5pZF0gPyBmb3JtVmFsdWVzW2ZpZWxkLmlkXS52YWxpZCA6IGZhbHNlXG4gICAgICB9XG4gICAgICBmb3JtVmFsdWVzPXtmb3JtVmFsdWVzfVxuICAgICAgc3VibWl0RmFpbGVkPXtzdWJtaXRGYWlsZWR9XG4gICAgICBzdWJtaXRTdWNjZXNzPXtzdWJtaXRTdWNjZXNzfVxuICAgICAgdG91Y2hlZD17dG91Y2hlZFtmaWVsZC5pZF19XG4gICAgICBzZXRUb3VjaGVkPXtzZXRUb3VjaGVkfVxuICAgICAgc2V0RXJyb3JNZXNzYWdlcz17c2V0RXJyb3JNZXNzYWdlc31cbiAgICAgIHVuc2V0RXJyb3I9e3Vuc2V0RXJyb3J9XG4gICAgICBlcnJvcj17ZXJyb3J9XG4gICAgICBwYWdlcz17cGFnZXN9XG4gICAgICBwcmV2U3RlcD17cHJldlN0ZXB9XG4gICAgICBuZXh0U3RlcD17bmV4dFN0ZXB9XG4gICAgICBpc05leHREaXNhYmxlZD17aXNOZXh0RGlzYWJsZWR9XG4gICAgICBoaWRlRmllbGQ9e2Zvcm1WYWx1ZXNbZmllbGQuaWRdID8gZm9ybVZhbHVlc1tmaWVsZC5pZF0uaGlkZUZpZWxkIDogZmFsc2V9XG4gICAgICBzYXZlU3RhdGVUb0h0bWxGaWVsZD17XG4gICAgICAgIGZpZWxkLnR5cGUgPT09IFwiaHRtbFwiICYmIGZpZWxkLmNzc0NsYXNzLmluZGV4T2YoXCJzZXQtc3RhdGVcIikgIT09IC0xXG4gICAgICAgICAgPyB7IGZvcm1WYWx1ZXMsIHNhdmVTdGF0ZVRvSHRtbEZpZWxkIH1cbiAgICAgICAgICA6IGZhbHNlXG4gICAgICB9XG4gICAgICBzdHlsZWRDb21wb25lbnRzPXtzdHlsZWRDb21wb25lbnRzfVxuICAgICAgY3NzQ2xhc3M9e2ZpZWxkQ2xhc3NOYW1lfVxuICAgICAgc2V0Rm9jdXNDbGFzcz17c2V0Rm9jdXNDbGFzc31cbiAgICAgIGNvbXBvbmVudD17Y3VzdG9tQ29tcG9uZW50cyAmJiAoY3VzdG9tQ29tcG9uZW50c1tmaWVsZC5pZF0gfHwgY3VzdG9tQ29tcG9uZW50c1tmaWVsZC5jc3NDbGFzc10pfVxuICAgICAgZHJvcHpvbmVUZXh0PXtkcm9wem9uZVRleHR9XG4gICAgICBsYW5ndWFnZT17bGFuZ3VhZ2V9XG4gICAgICBhcGlLZXlzPXthcGlLZXlzfVxuICAgIC8+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBSZW5kZXJGaWVsZDtcbiJdfQ==
"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FormConfirmation",{enumerable:!0,get:function get(){return _FormElements.FormConfirmation}}),Object.defineProperty(exports,"FormError",{enumerable:!0,get:function get(){return _FormElements.FormError}}),Object.defineProperty(exports,"RenderFields",{enumerable:!0,get:function get(){return _FormElements.RenderFields}}),Object.defineProperty(exports,"Submit",{enumerable:!0,get:function get(){return _FormElements.Submit}}),Object.defineProperty(exports,"validateField",{enumerable:!0,get:function get(){return _validation.validateField}}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=_interopRequireWildcard(require("react")),_isomorphicUnfetch=_interopRequireDefault(require("isomorphic-unfetch")),_FormElements=require("./FormElements"),_form=require("./Helpers/form"),_validation=require("./Helpers/validation");function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var GravityForm=function(a){var b,c=a.initialPage,d=a.populatedEntry,e=a.onChange,f=(0,_react.useState)(!1),g=(0,_slicedToArray2["default"])(f,2),h=g[0],i=g[1],j=(0,_react.useState)(!1),k=(0,_slicedToArray2["default"])(j,2),l=k[0],m=k[1],n=(0,_react.useState)({}),o=(0,_slicedToArray2["default"])(n,2),p=o[0],q=o[1],r=(0,_react.useState)(!1),s=(0,_slicedToArray2["default"])(r,2),t=s[0],u=s[1],v=(0,_react.useState)(!1),w=(0,_slicedToArray2["default"])(v,2),x=w[0],y=w[1],z=(0,_react.useState)(!1),A=(0,_slicedToArray2["default"])(z,2),B=A[0],C=A[1],D=(0,_react.useState)({}),E=(0,_slicedToArray2["default"])(D,2),F=E[0],G=E[1],H=(0,_react.useState)({}),I=(0,_slicedToArray2["default"])(H,2),J=I[0],K=I[1],L=(0,_react.useState)(c||1),M=(0,_slicedToArray2["default"])(L,2),N=M[0],O=M[1],P=(0,_react.useState)({}),Q=(0,_slicedToArray2["default"])(P,2),R=Q[0],S=Q[1],T=(0,_react.useState)({}),U=(0,_slicedToArray2["default"])(T,2),V=U[0],W=U[1],X=(0,_react.useState)(!1),Y=(0,_slicedToArray2["default"])(X,2),Z=Y[0],$=Y[1],_=(0,_react.useState)(!1),aa=(0,_slicedToArray2["default"])(_,2),ba=aa[0],ca=aa[1],da=(0,_react.useState)(!1),ea=(0,_slicedToArray2["default"])(da,2),fa=ea[0],ga=ea[1],ha=(0,_react.useState)({}),ia=(0,_slicedToArray2["default"])(ha,2),ja=ia[0],ka=ia[1],la=(0,_react.useRef)(null),ma=(0,_react.useCallback)(function(a){(0,_form.updateFieldsValuesBasedOnEntry)(a)},[]);(0,_react.useEffect)(function(){(0,_form.fetchForm)(_objectSpread({setFormData:G,setFormValues:q,setActivePage:O,setConditionFields:S,setConditionalIds:W,setPages:ka,setIsMultiPart:$},a))},[]),(0,_react.useEffect)(function(){e&&e(p)},[p]),(0,_react.useEffect)(function(){d&&ma(d)},[d]);var na=function(){if(la){var a=la.current.querySelector(".form-field.error");a&&a.scrollIntoView()}},oa=a.title,pa=a.formID,qa=a.submitIcon,ra=a.saveStateToHtmlField,sa=a.styledComponents,ta=a.customComponents,ua=a.errorMessage,va=a.dropzoneText,wa=a.loadingSpinner,xa=a.onError,ya=a.language,za=a.apiKeys,Aa=sa||!1,Ba=Aa.Button,Ca=Aa.Loading,Da=Aa.FormError,Ea=Aa.FormConfirmation,Fa=Aa.GFWrapper,Ga=void 0===Fa?"div":Fa,Ha=F.cssClass,Ia=function(a){a.preventDefault(),(0,_form.prevStep)(p,ja,N,O,ca)},Ja=function(){var b=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function b(c){var d,e,f,g,h,j,k,l,n,o;return _regenerator["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(d=a.onSubmit,e=a.filterFormData,f=new FormData(c.target),e&&(f=e(f,p)),c.preventDefault(),g=(0,_form.forceValidation)(N,p,ga,K),g){b.next=8;break}return na(),b.abrupt("return",!1);case 8:d?d(f):(u(!0),y(!1),i(!1),C(!1),m(!1),h=a.formID,j=a.backendUrl,k=a.jumpToConfirmation,l=a.onSubmitSuccess,n=a.onError,o=j.substring(0,j.indexOf("/wp-json")),(0,_isomorphicUnfetch["default"])("".concat(o,"/wp-json/gf/v2/forms/").concat(h,"/submissions"),{method:"POST",body:f}).then(function(a){return a.json()}).then(function(b){if(b&&b.is_valid){if(l){var g=l(b);if(!g)return!1}var c=b.confirmation_message,d=c||!1,e=d.type,f=d.link;if(e&&f&&"redirect"===e&&"undefined"!=typeof window)return window.location.replace(f),!1;u(!1),y(!0),C(c),k&&(0,_form.scrollToConfirmation)(a,la,k)}else throw{response:b}})["catch"](function(b){var c=b&&b.response&&b.response.validation_messages?b.response.validation_messages:"Something went wrong";n?(n(c),u(!1),i(!0)):(u(!1),i(!0),m(c)),k&&(0,_form.scrollToConfirmation)(a,la)}));case 9:case"end":return b.stop();}},b)}));return function onSubmit(){return b.apply(this,arguments)}}();return _react["default"].createElement(Ga,{ref:la,className:"form-wrapper",id:"gravity_form_".concat(pa)},F.title?null:Ca&&_react["default"].createElement(Ca,{isLoading:!0}),h&&!x&&!xa&&_react["default"].createElement(_FormElements.FormError,{SFormError:Da||!1,errorMessage:ua||"There was a problem with your submission"}),x&&B&&_react["default"].createElement(_FormElements.FormConfirmation,{confirmation:B,SFormConfirmation:Ea}),!x&&F.fields?_react["default"].createElement("form",{onSubmit:function onSubmit(a){return Ja(a)},className:Ha,encType:Z?"multipart/form-data":void 0,noValidate:!0},(F.title||F.description)&&_react["default"].createElement("div",null,F.title&&oa?_react["default"].createElement("h3",{className:"form-title"},F.title):null,F.description?_react["default"].createElement("p",{className:"form-description"},F.description):null),_react["default"].createElement("div",{className:"form-wrapper"},(null===F||void 0===F||null===(b=F.pagination)||void 0===b?void 0:b.pages)&&_react["default"].createElement(_FormElements.ProgressBar,{pagination:F.pagination,activePage:N,firstPageCssClass:F.firstPageCssClass}),_react["default"].createElement(_FormElements.RenderFields,(0,_extends2["default"])({styledComponents:sa,customComponents:ta,fields:F.fields,formValues:p,submitFailed:h,submitSuccess:x,updateForm:function updateForm(a,b,c){return(0,_form.updateFormHandler)(b,a,c,p,q,V,R)},touched:J,setTouched:function setTouched(a){return(0,_form.setTouchedHandler)(a,J,K)},setErrorMessages:m,pagination:F.pagination,activePage:N,prevStep:function prevStep(a){return Ia(a)},nextStep:function nextStep(b){return(0,_form.nextStep)(b,a,ja,p,N,O,ca,K,ga)},checkConditionalLogic:function checkConditionalLogic(a,b){return(0,_form.checkConditionalLogic)(a,b=!1)},saveStateToHtmlField:ra,enableHoneypot:F.enableHoneypot,errors:l,unsetError:function unsetError(a){return(0,_form.unsetError)(a,l)},dropzoneText:va,pageClicked:ba,language:ya,apiKeys:za},a)),(!F.pagination||F.pagination&&F.pagination.pages.length===N)&&_react["default"].createElement(_FormElements.Submit,{Button:Ba,Loading:Ca,formData:F,submitIcon:qa,submitting:t,prevStep:function prevStep(a){return Ia(a)},loadingSpinner:wa}))):"")};GravityForm.defaultProps={title:!0,submitIcon:!1,saveStateToHtmlField:!1,jumpToConfirmation:!0};var _default=GravityForm;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJHcmF2aXR5Rm9ybSIsInByb3BzIiwiaW5pdGlhbFBhZ2UiLCJwb3B1bGF0ZWRFbnRyeSIsIm9uQ2hhbmdlIiwic3VibWl0RmFpbGVkIiwic2V0U3VibWl0RmFpbGVkIiwiZXJyb3JNZXNzYWdlcyIsInNldEVycm9yTWVzc2FnZXMiLCJmb3JtVmFsdWVzIiwic2V0Rm9ybVZhbHVlcyIsInN1Ym1pdHRpbmciLCJzZXRTdWJtaXR0aW5nIiwic3VibWl0U3VjY2VzcyIsInNldFN1Ym1pdFN1Y2Nlc3MiLCJjb25maXJtYXRpb25NZXNzYWdlIiwic2V0Q29uZmlybWF0aW9uTWVzc2FnZSIsImZvcm1EYXRhIiwic2V0Rm9ybURhdGEiLCJ0b3VjaGVkIiwic2V0VG91Y2hlZCIsImFjdGl2ZVBhZ2UiLCJzZXRBY3RpdmVQYWdlIiwiY29uZGl0aW9uRmllbGRzIiwic2V0Q29uZGl0aW9uRmllbGRzIiwiY29uZGl0aW9uYWxJZHMiLCJzZXRDb25kaXRpb25hbElkcyIsImlzTXVsdGlwYXJ0Iiwic2V0SXNNdWx0aVBhcnQiLCJwYWdlQ2xpY2tlZCIsInNldFBhZ2VDbGlja2VkIiwic2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwic2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwicGFnZXMiLCJzZXRQYWdlcyIsIndyYXBwZXJSZWYiLCJ1cGRhdGVFbnRyeUZpZWxkcyIsInNjcm9sbFRvRmlyc3RJbnZhbGlkRmllbGQiLCJmaXJzdEVyckVsIiwiY3VycmVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzY3JvbGxJbnRvVmlldyIsInRpdGxlIiwiZm9ybUlEIiwic3VibWl0SWNvbiIsInNhdmVTdGF0ZVRvSHRtbEZpZWxkIiwic3R5bGVkQ29tcG9uZW50cyIsImN1c3RvbUNvbXBvbmVudHMiLCJlcnJvck1lc3NhZ2UiLCJkcm9wem9uZVRleHQiLCJsb2FkaW5nU3Bpbm5lciIsIm9uRXJyb3IiLCJsYW5ndWFnZSIsImFwaUtleXMiLCJCdXR0b24iLCJMb2FkaW5nIiwiU0Zvcm1FcnJvciIsIkZvcm1FcnJvciIsIlNGb3JtQ29uZmlybWF0aW9uIiwiRm9ybUNvbmZpcm1hdGlvbiIsIkdGV3JhcHBlciIsImNzc0NsYXNzIiwiaGFuZGxlUHJldlN0ZXAiLCJlIiwicHJldmVudERlZmF1bHQiLCJvblN1Ym1pdCIsImV2ZW50IiwiY3VzdG9tT25TdWJtaXQiLCJmaWx0ZXJGb3JtRGF0YSIsIkZvcm1EYXRhIiwidGFyZ2V0IiwiaXNGb3JtVmFsaWQiLCJiYWNrZW5kVXJsIiwianVtcFRvQ29uZmlybWF0aW9uIiwib25TdWJtaXRTdWNjZXNzIiwiZ2ZTdWJtaXNzaW9uVXJsIiwic3Vic3RyaW5nIiwiaW5kZXhPZiIsIm1ldGhvZCIsImJvZHkiLCJ0aGVuIiwicmVzcCIsImpzb24iLCJyZXNwb25zZSIsImlzX3ZhbGlkIiwicmVzIiwiY29uZmlybWF0aW9uX21lc3NhZ2UiLCJ0eXBlIiwibGluayIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVwbGFjZSIsImVycm9yIiwidmFsaWRhdGlvbl9tZXNzYWdlcyIsImZpZWxkcyIsImRlc2NyaXB0aW9uIiwicGFnaW5hdGlvbiIsImZpcnN0UGFnZUNzc0NsYXNzIiwiZmllbGQiLCJpbnB1dElEIiwiaWQiLCJjb25kaXRpb24iLCJlbmFibGVIb25leXBvdCIsImxlbmd0aCIsImRlZmF1bHRQcm9wcyJdLCJtYXBwaW5ncyI6InVrRUFtQkEsR0FBTUEsQ0FBQUEsV0FBVyxDQUFHLFNBQUFDLENBQUssQ0FBSSxPQUNuQkMsQ0FEbUIsQ0FDdUJELENBRHZCLENBQ25CQyxXQURtQixDQUNOQyxDQURNLENBQ3VCRixDQUR2QixDQUNORSxjQURNLENBQ1VDLENBRFYsQ0FDdUJILENBRHZCLENBQ1VHLFFBRFYsR0FHYSx1QkFIYix1Q0FHcEJDLENBSG9CLE1BR05DLENBSE0sUUFJZSx1QkFKZix1Q0FJcEJDLENBSm9CLE1BSUxDLENBSkssUUFLUyxvQkFBUyxFQUFULENBTFQsdUNBS3BCQyxDQUxvQixNQUtSQyxDQUxRLFFB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UUFBUSxDQUFFdUIsRUE5Q1osQ0ErQ0UsT0FBTyxDQUFFQyxFQS9DWCxFQWdETXBELENBaEROLEVBUkYsQ0EwREcsQ0FBQyxDQUFDZ0IsQ0FBUSxDQUFDK0UsVUFBVixFQUNDL0UsQ0FBUSxDQUFDK0UsVUFBVCxFQUF1Qi9FLENBQVEsQ0FBQytFLFVBQVQsQ0FBb0IvRCxLQUFwQixDQUEwQnNFLE1BQTFCLEdBQXFDbEYsQ0FEOUQsR0FFQyxnQ0FBQyxvQkFBRCxFQUNFLE1BQU0sQ0FBRWlDLEVBRFYsQ0FFRSxPQUFPLENBQUVDLEVBRlgsQ0FHRSxRQUFRLENBQUV0QyxDQUhaLENBSUUsVUFBVSxDQUFFMkIsRUFKZCxDQUtFLFVBQVUsQ0FBRWpDLENBTGQsQ0FNRSxRQUFRLENBQUUsa0JBQUFvRCxDQUFDLFFBQUlELENBQUFBLEVBQWMsQ0FBQ0MsQ0FBRCxDQUFsQixDQU5iLENBT0UsY0FBYyxDQUFFYixFQVBsQixFQTVESixDQWRGLENBREQsQ0F3RkMsRUF6R0osQ0E2R0gsQ0E1U0QsQ0E4U0FsRCxXQUFXLENBQUN3RyxZQUFaLENBQTJCLENBQ3pCOUQsS0FBSyxHQURvQixDQUV6QkUsVUFBVSxHQUZlLENBR3pCQyxvQkFBb0IsR0FISyxDQUl6QjRCLGtCQUFrQixHQUpPLEMsY0FTWnpFLFciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2ssIHVzZVJlZiB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBmZXRjaCBmcm9tICdpc29tb3JwaGljLXVuZmV0Y2gnO1xuaW1wb3J0IHsgRm9ybUNvbmZpcm1hdGlvbiwgRm9ybUVycm9yLCBSZW5kZXJGaWVsZHMsIFN1Ym1pdCwgUHJvZ3Jlc3NCYXIgfSBmcm9tICcuL0Zvcm1FbGVtZW50cyc7XG5cbmltcG9ydCB7XG4gIGNoZWNrQ29uZGl0aW9uYWxMb2dpYyxcbiAgZmV0Y2hGb3JtLFxuICBmb3JjZVZhbGlkYXRpb24sXG4gIG5leHRTdGVwLFxuICBwcmV2U3RlcCxcbiAgc2Nyb2xsVG9Db25maXJtYXRpb24sXG4gIHNldFRvdWNoZWRIYW5kbGVyLFxuICB1bnNldEVycm9yLFxuICB1cGRhdGVGaWVsZHNWYWx1ZXNCYXNlZE9uRW50cnksXG4gIHVwZGF0ZUZvcm1IYW5kbGVyLFxufSBmcm9tICcuL0hlbHBlcnMvZm9ybSc7XG5cbmltcG9ydCB7IHZhbGlkYXRlRmllbGQgfSBmcm9tICcuL0hlbHBlcnMvdmFsaWRhdGlvbic7XG5cbmNvbnN0IEdyYXZpdHlGb3JtID0gcHJvcHMgPT4ge1xuICBjb25zdCB7IGluaXRpYWxQYWdlLCBwb3B1bGF0ZWRFbnRyeSwgb25DaGFuZ2UgfSA9IHByb3BzO1xuXG4gIGNvbnN0IFtzdWJtaXRGYWlsZWQsIHNldFN1Ym1pdEZhaWxlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtlcnJvck1lc3NhZ2VzLCBzZXRFcnJvck1lc3NhZ2VzXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2Zvcm1WYWx1ZXMsIHNldEZvcm1WYWx1ZXNdID0gdXNlU3RhdGUoe30pO1xuICBjb25zdCBbc3VibWl0dGluZywgc2V0U3VibWl0dGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzdWJtaXRTdWNjZXNzLCBzZXRTdWJtaXRTdWNjZXNzXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2NvbmZpcm1hdGlvbk1lc3NhZ2UsIHNldENvbmZpcm1hdGlvbk1lc3NhZ2VdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZm9ybURhdGEsIHNldEZvcm1EYXRhXSA9IHVzZVN0YXRlKHt9KTtcbiAgY29uc3QgW3RvdWNoZWQsIHNldFRvdWNoZWRdID0gdXNlU3RhdGUoe30pO1xuICBjb25zdCBbYWN0aXZlUGFnZSwgc2V0QWN0aXZlUGFnZV0gPSB1c2VTdGF0ZShpbml0aWFsUGFnZSB8fCAxKTtcbiAgY29uc3QgW2NvbmRpdGlvbkZpZWxkcywgc2V0Q29uZGl0aW9uRmllbGRzXSA9IHVzZVN0YXRlKHt9KTtcbiAgY29uc3QgW2NvbmRpdGlvbmFsSWRzLCBzZXRDb25kaXRpb25hbElkc10gPSB1c2VTdGF0ZSh7fSk7XG4gIGNvbnN0IFtpc011bHRpcGFydCwgc2V0SXNNdWx0aVBhcnRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcGFnZUNsaWNrZWQsIHNldFBhZ2VDbGlja2VkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3Nob3dQYWdlVmFsaWRhdGlvbk1zZywgc2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3BhZ2VzLCBzZXRQYWdlc10gPSB1c2VTdGF0ZSh7fSk7XG5cbiAgY29uc3Qgd3JhcHBlclJlZiA9IHVzZVJlZihudWxsKTtcblxuICBjb25zdCB1cGRhdGVFbnRyeUZpZWxkcyA9IHVzZUNhbGxiYWNrKHBvcHVsYXRlZEVudHJ5ID0+IHtcbiAgICB1cGRhdGVGaWVsZHNWYWx1ZXNCYXNlZE9uRW50cnkocG9wdWxhdGVkRW50cnkpO1xuICB9LCBbXSk7XG5cbiAgLyoqXG4gICAqIEZldGNoIGZvcm0gZGF0YVxuICAgKi9cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBmZXRjaEZvcm0oe1xuICAgICAgc2V0Rm9ybURhdGEsXG4gICAgICBzZXRGb3JtVmFsdWVzLFxuICAgICAgc2V0QWN0aXZlUGFnZSxcbiAgICAgIHNldENvbmRpdGlvbkZpZWxkcyxcbiAgICAgIHNldENvbmRpdGlvbmFsSWRzLFxuICAgICAgc2V0UGFnZXMsXG4gICAgICBzZXRJc011bHRpUGFydCxcbiAgICAgIC4uLnByb3BzLFxuICAgIH0pO1xuICB9LCBbXSk7XG5cbiAgLyoqXG4gICAqIENhbGwgY3VzdG9tIG9uQ2hhbmdlIGhhbmRsZXIgd2l0aCBwYXNzZWQgdmFsdWVzIGZyb20gZm9ybVxuICAgKi9cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAob25DaGFuZ2UpIHtcbiAgICAgIG9uQ2hhbmdlKGZvcm1WYWx1ZXMpO1xuICAgIH1cbiAgfSwgW2Zvcm1WYWx1ZXNdKTtcblxuICAvKipcbiAgICogU2V0IGVudHJ5IHRvIHRoZSBmb3JtXG4gICAqL1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChwb3B1bGF0ZWRFbnRyeSkge1xuICAgICAgdXBkYXRlRW50cnlGaWVsZHMocG9wdWxhdGVkRW50cnkpO1xuICAgIH1cbiAgfSwgW3BvcHVsYXRlZEVudHJ5XSk7XG5cbiAgLyoqXG4gICAqIFNjcm9sbCBwYWdlIHRvIHRoZSBmaXJzdCBub3QgdmFsaWQgZmllbGRcbiAgICovXG4gIGNvbnN0IHNjcm9sbFRvRmlyc3RJbnZhbGlkRmllbGQgPSAoKSA9PiB7XG4gICAgaWYgKCF3cmFwcGVyUmVmKSByZXR1cm47XG5cbiAgICBjb25zdCBmaXJzdEVyckVsID0gd3JhcHBlclJlZi5jdXJyZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWZpZWxkLmVycm9yJyk7XG4gICAgaWYgKGZpcnN0RXJyRWwpIHtcbiAgICAgIGZpcnN0RXJyRWwuc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qge1xuICAgIHRpdGxlLFxuICAgIGZvcm1JRCxcbiAgICBzdWJtaXRJY29uLFxuICAgIHNhdmVTdGF0ZVRvSHRtbEZpZWxkLFxuICAgIHN0eWxlZENvbXBvbmVudHMsXG4gICAgY3VzdG9tQ29tcG9uZW50cyxcbiAgICBlcnJvck1lc3NhZ2UsXG4gICAgZHJvcHpvbmVUZXh0LFxuICAgIGxvYWRpbmdTcGlubmVyLFxuICAgIG9uRXJyb3IsXG4gICAgbGFuZ3VhZ2UsXG4gICAgYXBpS2V5cyxcbiAgfSA9IHByb3BzO1xuXG4gIGNvbnN0IHtcbiAgICBCdXR0b24sXG4gICAgTG9hZGluZyxcbiAgICBGb3JtRXJyb3I6IFNGb3JtRXJyb3IsXG4gICAgRm9ybUNvbmZpcm1hdGlvbjogU0Zvcm1Db25maXJtYXRpb24sXG4gICAgR0ZXcmFwcGVyID0gJ2RpdicsXG4gIH0gPSBzdHlsZWRDb21wb25lbnRzIHx8IGZhbHNlO1xuXG4gIGNvbnN0IHsgY3NzQ2xhc3MgfSA9IGZvcm1EYXRhO1xuXG4gIGNvbnN0IGhhbmRsZVByZXZTdGVwID0gZSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHByZXZTdGVwKGZvcm1WYWx1ZXMsIHBhZ2VzLCBhY3RpdmVQYWdlLCBzZXRBY3RpdmVQYWdlLCBzZXRQYWdlQ2xpY2tlZCk7XG4gIH07XG5cbiAgY29uc3Qgb25TdWJtaXQgPSBhc3luYyBldmVudCA9PiB7XG4gICAgY29uc3QgeyBvblN1Ym1pdDogY3VzdG9tT25TdWJtaXQsIGZpbHRlckZvcm1EYXRhIH0gPSBwcm9wcztcbiAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZXZlbnQudGFyZ2V0KTtcblxuICAgIGlmIChmaWx0ZXJGb3JtRGF0YSkgZm9ybURhdGEgPSBmaWx0ZXJGb3JtRGF0YShmb3JtRGF0YSwgZm9ybVZhbHVlcyk7XG5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgaXNGb3JtVmFsaWQgPSBmb3JjZVZhbGlkYXRpb24oXG4gICAgICBhY3RpdmVQYWdlLFxuICAgICAgZm9ybVZhbHVlcyxcbiAgICAgIHNldFNob3dQYWdlVmFsaWRhdGlvbk1zZyxcbiAgICAgIHNldFRvdWNoZWRcbiAgICApO1xuXG4gICAgaWYgKCFpc0Zvcm1WYWxpZCkge1xuICAgICAgc2Nyb2xsVG9GaXJzdEludmFsaWRGaWVsZCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChjdXN0b21PblN1Ym1pdCkge1xuICAgICAgY3VzdG9tT25TdWJtaXQoZm9ybURhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRTdWJtaXR0aW5nKHRydWUpO1xuICAgICAgc2V0U3VibWl0U3VjY2VzcyhmYWxzZSk7XG4gICAgICBzZXRTdWJtaXRGYWlsZWQoZmFsc2UpO1xuICAgICAgc2V0Q29uZmlybWF0aW9uTWVzc2FnZShmYWxzZSk7XG4gICAgICBzZXRFcnJvck1lc3NhZ2VzKGZhbHNlKTtcblxuICAgICAgY29uc3QgeyBmb3JtSUQsIGJhY2tlbmRVcmwsIGp1bXBUb0NvbmZpcm1hdGlvbiwgb25TdWJtaXRTdWNjZXNzLCBvbkVycm9yIH0gPSBwcm9wcztcbiAgICAgIGNvbnN0IGdmU3VibWlzc2lvblVybCA9IGJhY2tlbmRVcmwuc3Vic3RyaW5nKDAsIGJhY2tlbmRVcmwuaW5kZXhPZignL3dwLWpzb24nKSk7XG5cbiAgICAgIGZldGNoKGAke2dmU3VibWlzc2lvblVybH0vd3AtanNvbi9nZi92Mi9mb3Jtcy8ke2Zvcm1JRH0vc3VibWlzc2lvbnNgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBmb3JtRGF0YSxcbiAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlc3AgPT4gcmVzcC5qc29uKCkpXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuaXNfdmFsaWQpIHtcbiAgICAgICAgICAgIGlmIChvblN1Ym1pdFN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgY29uc3QgcmVzID0gb25TdWJtaXRTdWNjZXNzKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgaWYgKCFyZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1hdGlvbk1lc3NhZ2UgPSByZXNwb25zZS5jb25maXJtYXRpb25fbWVzc2FnZTtcbiAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgbGluayB9ID0gY29uZmlybWF0aW9uTWVzc2FnZSB8fCBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0eXBlICYmIGxpbmsgJiYgdHlwZSA9PT0gJ3JlZGlyZWN0Jykge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShsaW5rKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgc2V0U3VibWl0U3VjY2Vzcyh0cnVlKTtcbiAgICAgICAgICAgIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UoY29uZmlybWF0aW9uTWVzc2FnZSk7XG5cbiAgICAgICAgICAgIGlmIChqdW1wVG9Db25maXJtYXRpb24pIHtcbiAgICAgICAgICAgICAgc2Nyb2xsVG9Db25maXJtYXRpb24ocHJvcHMsIHdyYXBwZXJSZWYsIGp1bXBUb0NvbmZpcm1hdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IHtcbiAgICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID1cbiAgICAgICAgICAgIGVycm9yICYmIGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLnZhbGlkYXRpb25fbWVzc2FnZXNcbiAgICAgICAgICAgICAgPyBlcnJvci5yZXNwb25zZS52YWxpZGF0aW9uX21lc3NhZ2VzXG4gICAgICAgICAgICAgIDogJ1NvbWV0aGluZyB3ZW50IHdyb25nJztcblxuICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICBvbkVycm9yKGVycm9yTWVzc2FnZXMpO1xuICAgICAgICAgICAgc2V0U3VibWl0dGluZyhmYWxzZSk7XG4gICAgICAgICAgICBzZXRTdWJtaXRGYWlsZWQodHJ1ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgc2V0U3VibWl0RmFpbGVkKHRydWUpO1xuICAgICAgICAgICAgc2V0RXJyb3JNZXNzYWdlcyhlcnJvck1lc3NhZ2VzKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoanVtcFRvQ29uZmlybWF0aW9uKSB7XG4gICAgICAgICAgICBzY3JvbGxUb0NvbmZpcm1hdGlvbihwcm9wcywgd3JhcHBlclJlZik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8R0ZXcmFwcGVyIHJlZj17d3JhcHBlclJlZn0gY2xhc3NOYW1lPVwiZm9ybS13cmFwcGVyXCIgaWQ9e2BncmF2aXR5X2Zvcm1fJHtmb3JtSUR9YH0+XG4gICAgICB7Zm9ybURhdGEudGl0bGUgPyBudWxsIDogTG9hZGluZyAmJiA8TG9hZGluZyBpc0xvYWRpbmcgLz59XG5cbiAgICAgIHtzdWJtaXRGYWlsZWQgJiYgIXN1Ym1pdFN1Y2Nlc3MgJiYgIW9uRXJyb3IgJiYgKFxuICAgICAgICA8Rm9ybUVycm9yXG4gICAgICAgICAgU0Zvcm1FcnJvcj17U0Zvcm1FcnJvciB8fCBmYWxzZX1cbiAgICAgICAgICBlcnJvck1lc3NhZ2U9e2Vycm9yTWVzc2FnZSB8fCAnVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHlvdXIgc3VibWlzc2lvbid9XG4gICAgICAgIC8+XG4gICAgICApfVxuXG4gICAgICB7c3VibWl0U3VjY2VzcyAmJiBjb25maXJtYXRpb25NZXNzYWdlICYmIChcbiAgICAgICAgPEZvcm1Db25maXJtYXRpb25cbiAgICAgICAgICBjb25maXJtYXRpb249e2NvbmZpcm1hdGlvbk1lc3NhZ2V9XG4gICAgICAgICAgU0Zvcm1Db25maXJtYXRpb249e1NGb3JtQ29uZmlybWF0aW9ufVxuICAgICAgICAvPlxuICAgICAgKX1cblxuICAgICAgeyFzdWJtaXRTdWNjZXNzICYmIGZvcm1EYXRhLmZpZWxkcyA/IChcbiAgICAgICAgPGZvcm1cbiAgICAgICAgICBvblN1Ym1pdD17ZXZlbnQgPT4gb25TdWJtaXQoZXZlbnQpfVxuICAgICAgICAgIGNsYXNzTmFtZT17Y3NzQ2xhc3N9XG4gICAgICAgICAgZW5jVHlwZT17aXNNdWx0aXBhcnQgPyAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScgOiB1bmRlZmluZWR9XG4gICAgICAgICAgbm9WYWxpZGF0ZVxuICAgICAgICA+XG4gICAgICAgICAgeyhmb3JtRGF0YS50aXRsZSB8fCBmb3JtRGF0YS5kZXNjcmlwdGlvbikgJiYgKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAge2Zvcm1EYXRhLnRpdGxlICYmIHRpdGxlID8gPGgzIGNsYXNzTmFtZT1cImZvcm0tdGl0bGVcIj57Zm9ybURhdGEudGl0bGV9PC9oMz4gOiBudWxsfVxuICAgICAgICAgICAgICB7Zm9ybURhdGEuZGVzY3JpcHRpb24gPyAoXG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZm9ybS1kZXNjcmlwdGlvblwiPntmb3JtRGF0YS5kZXNjcmlwdGlvbn08L3A+XG4gICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0td3JhcHBlclwiPlxuICAgICAgICAgICAge2Zvcm1EYXRhPy5wYWdpbmF0aW9uPy5wYWdlcyAmJiAoXG4gICAgICAgICAgICAgIDxQcm9ncmVzc0JhclxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb249e2Zvcm1EYXRhLnBhZ2luYXRpb259XG4gICAgICAgICAgICAgICAgYWN0aXZlUGFnZT17YWN0aXZlUGFnZX1cbiAgICAgICAgICAgICAgICBmaXJzdFBhZ2VDc3NDbGFzcz17Zm9ybURhdGEuZmlyc3RQYWdlQ3NzQ2xhc3N9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPFJlbmRlckZpZWxkc1xuICAgICAgICAgICAgICBzdHlsZWRDb21wb25lbnRzPXtzdHlsZWRDb21wb25lbnRzfVxuICAgICAgICAgICAgICBjdXN0b21Db21wb25lbnRzPXtjdXN0b21Db21wb25lbnRzfVxuICAgICAgICAgICAgICBmaWVsZHM9e2Zvcm1EYXRhLmZpZWxkc31cbiAgICAgICAgICAgICAgZm9ybVZhbHVlcz17Zm9ybVZhbHVlc31cbiAgICAgICAgICAgICAgc3VibWl0RmFpbGVkPXtzdWJtaXRGYWlsZWR9XG4gICAgICAgICAgICAgIHN1Ym1pdFN1Y2Nlc3M9e3N1Ym1pdFN1Y2Nlc3N9XG4gICAgICAgICAgICAgIHVwZGF0ZUZvcm09eyhldmVudCwgZmllbGQsIGlucHV0SUQpID0+XG4gICAgICAgICAgICAgICAgdXBkYXRlRm9ybUhhbmRsZXIoXG4gICAgICAgICAgICAgICAgICBmaWVsZCxcbiAgICAgICAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgICAgICAgaW5wdXRJRCxcbiAgICAgICAgICAgICAgICAgIGZvcm1WYWx1ZXMsXG4gICAgICAgICAgICAgICAgICBzZXRGb3JtVmFsdWVzLFxuICAgICAgICAgICAgICAgICAgY29uZGl0aW9uYWxJZHMsXG4gICAgICAgICAgICAgICAgICBjb25kaXRpb25GaWVsZHNcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdG91Y2hlZD17dG91Y2hlZH1cbiAgICAgICAgICAgICAgc2V0VG91Y2hlZD17aWQgPT4gc2V0VG91Y2hlZEhhbmRsZXIoaWQsIHRvdWNoZWQsIHNldFRvdWNoZWQpfVxuICAgICAgICAgICAgICBzZXRFcnJvck1lc3NhZ2VzPXtzZXRFcnJvck1lc3NhZ2VzfVxuICAgICAgICAgICAgICBwYWdpbmF0aW9uPXtmb3JtRGF0YS5wYWdpbmF0aW9ufVxuICAgICAgICAgICAgICBhY3RpdmVQYWdlPXthY3RpdmVQYWdlfVxuICAgICAgICAgICAgICBwcmV2U3RlcD17ZSA9PiBoYW5kbGVQcmV2U3RlcChlKX1cbiAgICAgICAgICAgICAgbmV4dFN0ZXA9e2UgPT5cbiAgICAgICAgICAgICAgICBuZXh0U3RlcChcbiAgICAgICAgICAgICAgICAgIGUsXG4gICAgICAgICAgICAgICAgICBwcm9wcyxcbiAgICAgICAgICAgICAgICAgIHBhZ2VzLFxuICAgICAgICAgICAgICAgICAgZm9ybVZhbHVlcyxcbiAgICAgICAgICAgICAgICAgIGFjdGl2ZVBhZ2UsXG4gICAgICAgICAgICAgICAgICBzZXRBY3RpdmVQYWdlLFxuICAgICAgICAgICAgICAgICAgc2V0UGFnZUNsaWNrZWQsXG4gICAgICAgICAgICAgICAgICBzZXRUb3VjaGVkLFxuICAgICAgICAgICAgICAgICAgc2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNoZWNrQ29uZGl0aW9uYWxMb2dpYz17KGNvbmRpdGlvbiwgZmllbGRzKSA9PlxuICAgICAgICAgICAgICAgIGNoZWNrQ29uZGl0aW9uYWxMb2dpYyhjb25kaXRpb24sIChmaWVsZHMgPSBmYWxzZSkpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc2F2ZVN0YXRlVG9IdG1sRmllbGQ9e3NhdmVTdGF0ZVRvSHRtbEZpZWxkfVxuICAgICAgICAgICAgICBlbmFibGVIb25leXBvdD17Zm9ybURhdGEuZW5hYmxlSG9uZXlwb3R9XG4gICAgICAgICAgICAgIGVycm9ycz17ZXJyb3JNZXNzYWdlc31cbiAgICAgICAgICAgICAgdW5zZXRFcnJvcj17aWQgPT4gdW5zZXRFcnJvcihpZCwgZXJyb3JNZXNzYWdlcyl9XG4gICAgICAgICAgICAgIGRyb3B6b25lVGV4dD17ZHJvcHpvbmVUZXh0fVxuICAgICAgICAgICAgICBwYWdlQ2xpY2tlZD17cGFnZUNsaWNrZWR9XG4gICAgICAgICAgICAgIGxhbmd1YWdlPXtsYW5ndWFnZX1cbiAgICAgICAgICAgICAgYXBpS2V5cz17YXBpS2V5c31cbiAgICAgICAgICAgICAgey4uLnByb3BzfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHsoIWZvcm1EYXRhLnBhZ2luYXRpb24gfHxcbiAgICAgICAgICAgICAgKGZvcm1EYXRhLnBhZ2luYXRpb24gJiYgZm9ybURhdGEucGFnaW5hdGlvbi5wYWdlcy5sZW5ndGggPT09IGFjdGl2ZVBhZ2UpKSAmJiAoXG4gICAgICAgICAgICAgIDxTdWJtaXRcbiAgICAgICAgICAgICAgICBCdXR0b249e0J1dHRvbn1cbiAgICAgICAgICAgICAgICBMb2FkaW5nPXtMb2FkaW5nfVxuICAgICAgICAgICAgICAgIGZvcm1EYXRhPXtmb3JtRGF0YX1cbiAgICAgICAgICAgICAgICBzdWJtaXRJY29uPXtzdWJtaXRJY29ufVxuICAgICAgICAgICAgICAgIHN1Ym1pdHRpbmc9e3N1Ym1pdHRpbmd9XG4gICAgICAgICAgICAgICAgcHJldlN0ZXA9e2UgPT4gaGFuZGxlUHJldlN0ZXAoZSl9XG4gICAgICAgICAgICAgICAgbG9hZGluZ1NwaW5uZXI9e2xvYWRpbmdTcGlubmVyfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9mb3JtPlxuICAgICAgKSA6IChcbiAgICAgICAgJydcbiAgICAgICl9XG4gICAgPC9HRldyYXBwZXI+XG4gICk7XG59O1xuXG5HcmF2aXR5Rm9ybS5kZWZhdWx0UHJvcHMgPSB7XG4gIHRpdGxlOiB0cnVlLFxuICBzdWJtaXRJY29uOiBmYWxzZSxcbiAgc2F2ZVN0YXRlVG9IdG1sRmllbGQ6IGZhbHNlLFxuICBqdW1wVG9Db25maXJtYXRpb246IHRydWUsXG59O1xuXG5leHBvcnQgeyB2YWxpZGF0ZUZpZWxkLCBGb3JtQ29uZmlybWF0aW9uLCBGb3JtRXJyb3IsIFJlbmRlckZpZWxkcywgU3VibWl0IH07XG5cbmV4cG9ydCBkZWZhdWx0IEdyYXZpdHlGb3JtO1xuXG4iXX0=
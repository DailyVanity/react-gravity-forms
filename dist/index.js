"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FormConfirmation",{enumerable:!0,get:function get(){return _FormElements.FormConfirmation}}),Object.defineProperty(exports,"FormError",{enumerable:!0,get:function get(){return _FormElements.FormError}}),Object.defineProperty(exports,"RenderFields",{enumerable:!0,get:function get(){return _FormElements.RenderFields}}),Object.defineProperty(exports,"Submit",{enumerable:!0,get:function get(){return _FormElements.Submit}}),Object.defineProperty(exports,"validateField",{enumerable:!0,get:function get(){return _validation.validateField}}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=_interopRequireWildcard(require("react")),_isomorphicUnfetch=_interopRequireDefault(require("isomorphic-unfetch")),_FormElements=require("./FormElements"),_form=require("./Helpers/form"),_validation=require("./Helpers/validation");function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var GravityForm=function(a){var b,c=a.initialPage,d=a.populatedEntry,e=a.onChange,f=(0,_react.useState)(!1),g=(0,_slicedToArray2["default"])(f,2),h=g[0],i=g[1],j=(0,_react.useState)(!1),k=(0,_slicedToArray2["default"])(j,2),l=k[0],m=k[1],n=(0,_react.useState)({}),o=(0,_slicedToArray2["default"])(n,2),p=o[0],q=o[1],r=(0,_react.useState)(!1),s=(0,_slicedToArray2["default"])(r,2),t=s[0],u=s[1],v=(0,_react.useState)(!1),w=(0,_slicedToArray2["default"])(v,2),x=w[0],y=w[1],z=(0,_react.useState)(!1),A=(0,_slicedToArray2["default"])(z,2),B=A[0],C=A[1],D=(0,_react.useState)({}),E=(0,_slicedToArray2["default"])(D,2),F=E[0],G=E[1],H=(0,_react.useState)({}),I=(0,_slicedToArray2["default"])(H,2),J=I[0],K=I[1],L=(0,_react.useState)(c||1),M=(0,_slicedToArray2["default"])(L,2),N=M[0],O=M[1],P=(0,_react.useState)({}),Q=(0,_slicedToArray2["default"])(P,2),R=Q[0],S=Q[1],T=(0,_react.useState)({}),U=(0,_slicedToArray2["default"])(T,2),V=U[0],W=U[1],X=(0,_react.useState)(!1),Y=(0,_slicedToArray2["default"])(X,2),Z=Y[0],$=Y[1],_=(0,_react.useState)(!1),aa=(0,_slicedToArray2["default"])(_,2),ba=aa[0],ca=aa[1],da=(0,_react.useState)(!1),ea=(0,_slicedToArray2["default"])(da,2),fa=ea[0],ga=ea[1],ha=(0,_react.useState)({}),ia=(0,_slicedToArray2["default"])(ha,2),ja=ia[0],ka=ia[1],la=(0,_react.useRef)(null),ma=(0,_react.useCallback)(function(a){(0,_form.updateFieldsValuesBasedOnEntry)(a)},[]);(0,_react.useEffect)(function(){(0,_form.fetchForm)(_objectSpread({setFormData:G,setFormValues:q,setActivePage:O,setConditionFields:S,setConditionalIds:W,setPages:ka,setIsMultiPart:$},a))},[]),(0,_react.useEffect)(function(){e&&e(p)},[p]),(0,_react.useEffect)(function(){d&&ma(d)},[d]);var na=function(){if(la){var a=la.current.querySelector(".form-field.error");a&&a.scrollIntoView()}},oa=a.title,pa=a.formID,qa=a.submitIcon,ra=a.saveStateToHtmlField,sa=a.styledComponents,ta=a.customComponents,ua=a.errorMessage,va=a.dropzoneText,wa=a.loadingSpinner,xa=a.onError,ya=a.language,za=a.apiKeys,Aa=sa||!1,Ba=Aa.Button,Ca=Aa.Loading,Da=Aa.FormError,Ea=Aa.FormConfirmation,Fa=Aa.GFWrapper,Ga=void 0===Fa?"div":Fa,Ha=F.cssClass,Ia=function(a){a.preventDefault(),(0,_form.prevStep)(p,ja,N,O,ca)},Ja=function(){var b=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function b(c){var d,e,f,g,h,j,k,l,n;return _regenerator["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(d=a.onSubmit,e=new FormData(c.target),c.preventDefault(),f=(0,_form.forceValidation)(N,p,ga,K),f){b.next=7;break}return na(),b.abrupt("return",!1);case 7:d?d(e):(u(!0),y(!1),i(!1),C(!1),m(!1),g=a.formID,h=a.backendUrl,j=a.jumpToConfirmation,k=a.onSubmitSuccess,l=a.onError,n=h.substring(0,h.indexOf("/wp-json")),(0,_isomorphicUnfetch["default"])("".concat(n,"/wp-json/gf/v2/forms/").concat(g,"/submissions"),{method:"POST",body:e}).then(function(a){return a.json()}).then(function(b){if(b&&b.is_valid){if(k){var g=k(b);if(!g)return!1}var c=b.confirmation_message,d=c||!1,e=d.type,f=d.link;if(e&&f&&"redirect"===e&&"undefined"!=typeof window)return window.location.replace(f),!1;u(!1),y(!0),C(c),j&&(0,_form.scrollToConfirmation)(a,la,j)}else throw{response:b}})["catch"](function(b){var c=b&&b.response&&b.response.validation_messages?b.response.validation_messages:"Something went wrong";l?(l(c),u(!1),i(!0)):(u(!1),i(!0),m(c)),j&&(0,_form.scrollToConfirmation)(a,la)}));case 8:case"end":return b.stop();}},b)}));return function onSubmit(){return b.apply(this,arguments)}}();return _react["default"].createElement(Ga,{ref:la,className:"form-wrapper",id:"gravity_form_".concat(pa)},F.title?null:Ca&&_react["default"].createElement(Ca,{isLoading:!0}),h&&!x&&!xa&&_react["default"].createElement(_FormElements.FormError,{SFormError:Da||!1,errorMessage:ua||"There was a problem with your submission"}),x&&B&&_react["default"].createElement(_FormElements.FormConfirmation,{confirmation:B,SFormConfirmation:Ea}),!x&&F.fields?_react["default"].createElement("form",{onSubmit:function onSubmit(a){return Ja(a)},className:Ha,encType:Z?"multipart/form-data":void 0,noValidate:!0},(F.title||F.description)&&_react["default"].createElement("div",null,F.title&&oa?_react["default"].createElement("h3",{className:"form-title"},F.title):null,F.description?_react["default"].createElement("p",{className:"form-description"},F.description):null),_react["default"].createElement("div",{className:"form-wrapper"},(null===F||void 0===F||null===(b=F.pagination)||void 0===b?void 0:b.pages)&&_react["default"].createElement(_FormElements.ProgressBar,{pagination:F.pagination,activePage:N,firstPageCssClass:F.firstPageCssClass}),_react["default"].createElement(_FormElements.RenderFields,{styledComponents:sa,customComponents:ta,fields:F.fields,formValues:p,submitFailed:h,submitSuccess:x,updateForm:function updateForm(a,b,c){return(0,_form.updateFormHandler)(b,a,c,p,q,V,R)},touched:J,setTouched:function setTouched(a){return(0,_form.setTouchedHandler)(a,J,K)},setErrorMessages:m,pagination:F.pagination,activePage:N,prevStep:function prevStep(a){return Ia(a)},nextStep:function nextStep(b){return(0,_form.nextStep)(b,a,ja,p,N,O,ca,K,ga)},checkConditionalLogic:function checkConditionalLogic(a,b){return(0,_form.checkConditionalLogic)(a,b=!1)},saveStateToHtmlField:ra,enableHoneypot:F.enableHoneypot,errors:l,unsetError:function unsetError(a){return(0,_form.unsetError)(a,l)},dropzoneText:va,pageClicked:ba,language:ya,apiKeys:za}),(!F.pagination||F.pagination&&F.pagination.pages.length===N)&&_react["default"].createElement(_FormElements.Submit,{Button:Ba,Loading:Ca,formData:F,submitIcon:qa,submitting:t,prevStep:function prevStep(a){return Ia(a)},loadingSpinner:wa}))):"")};GravityForm.defaultProps={title:!0,submitIcon:!1,saveStateToHtmlField:!1,jumpToConfirmation:!0};var _default=GravityForm;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJHcmF2aXR5Rm9ybSIsInByb3BzIiwiaW5pdGlhbFBhZ2UiLCJwb3B1bGF0ZWRFbnRyeSIsIm9uQ2hhbmdlIiwic3VibWl0RmFpbGVkIiwic2V0U3VibWl0RmFpbGVkIiwiZXJyb3JNZXNzYWdlcyIsInNldEVycm9yTWVzc2FnZXMiLCJmb3JtVmFsdWVzIiwic2V0Rm9ybVZhbHVlcyIsInN1Ym1pdHRpbmciLCJzZXRTdWJtaXR0aW5nIiwic3VibWl0U3VjY2VzcyIsInNldFN1Ym1pdFN1Y2Nlc3MiLCJjb25maXJtYXRpb25NZXNzYWdlIiwic2V0Q29uZmlybWF0aW9uTWVzc2FnZSIsImZvcm1EYXRhIiwic2V0Rm9ybURhdGEiLCJ0b3VjaGVkIiwic2V0VG91Y2hlZCIsImFjdGl2ZVBhZ2UiLCJzZXRBY3RpdmVQYWdlIiwiY29uZGl0aW9uRmllbGRzIiwic2V0Q29uZGl0aW9uRmllbGRzIiwiY29uZGl0aW9uYWxJZHMiLCJzZXRDb25kaXRpb25hbElkcyIsImlzTXVsdGlwYXJ0Iiwic2V0SXNNdWx0aVBhcnQiLCJwYWdlQ2xpY2tlZCIsInNldFBhZ2VDbGlja2VkIiwic2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwic2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwicGFnZXMiLCJzZXRQYWdlcyIsIndyYXBwZXJSZWYiLCJ1cGRhdGVFbnRyeUZpZWxkcyIsInNjcm9sbFRvRmlyc3RJbnZhbGlkRmllbGQiLCJmaXJzdEVyckVsIiwiY3VycmVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzY3JvbGxJbnRvVmlldyIsInRpdGxlIiwiZm9ybUlEIiwic3VibWl0SWNvbiIsInNhdmVTdGF0ZVRvSHRtbEZpZWxkIiwic3R5bGVkQ29tcG9uZW50cyIsImN1c3RvbUNvbXBvbmVudHMiLCJlcnJvck1lc3NhZ2UiLCJkcm9wem9uZVRleHQiLCJsb2FkaW5nU3Bpbm5lciIsIm9uRXJyb3IiLCJsYW5ndWFnZSIsImFwaUtleXMiLCJCdXR0b24iLCJMb2FkaW5nIiwiU0Zvcm1FcnJvciIsIkZvcm1FcnJvciIsIlNGb3JtQ29uZmlybWF0aW9uIiwiRm9ybUNvbmZpcm1hdGlvbiIsIkdGV3JhcHBlciIsImNzc0NsYXNzIiwiaGFuZGxlUHJldlN0ZXAiLCJlIiwicHJldmVudERlZmF1bHQiLCJvblN1Ym1pdCIsImV2ZW50IiwiY3VzdG9tT25TdWJtaXQiLCJGb3JtRGF0YSIsInRhcmdldCIsImlzRm9ybVZhbGlkIiwiYmFja2VuZFVybCIsImp1bXBUb0NvbmZpcm1hdGlvbiIsIm9uU3VibWl0U3VjY2VzcyIsImdmU3VibWlzc2lvblVybCIsInN1YnN0cmluZyIsImluZGV4T2YiLCJtZXRob2QiLCJib2R5IiwidGhlbiIsInJlc3AiLCJqc29uIiwicmVzcG9uc2UiLCJpc192YWxpZCIsInJlcyIsImNvbmZpcm1hdGlvbl9tZXNzYWdlIiwidHlwZSIsImxpbmsiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlcGxhY2UiLCJlcnJvciIsInZhbGlkYXRpb25fbWVzc2FnZXMiLCJmaWVsZHMiLCJkZXNjcmlwdGlvbiIsInBhZ2luYXRpb24iLCJmaXJzdFBhZ2VDc3NDbGFzcyIsImZpZWxkIiwiaW5wdXRJRCIsImlkIiwiY29uZGl0aW9uIiwiZW5hYmxlSG9uZXlwb3QiLCJsZW5ndGgiLCJkZWZhdWx0UHJvcHMiXSwibWFwcGluZ3MiOiIyL0RBeUJBLEdBQU1BLENBQUFBLFdBQVcsQ0FBRyxTQUFDQyxDQUFELENBQVcsT0FDckJDLENBRHFCLENBQ3FCRCxDQURyQixDQUNyQkMsV0FEcUIsQ0FDUkMsQ0FEUSxDQUNxQkYsQ0FEckIsQ0FDUkUsY0FEUSxDQUNRQyxDQURSLENBQ3FCSCxDQURyQixDQUNRRyxRQURSLEdBR1csdUJBSFgsdUNBR3RCQyxDQUhzQixNQUdSQyxDQUhRLFFBSWEsdUJBSmIsdUNBSXRCQyxDQUpzQixNQUlQQyxDQUpPLFFBS08sb0JBQVMsRUFBVCxDQUxQLHVDQUt0QkMsQ0FMc0IsTUFLVkMsQ0FMVSxRQU1PLHVCQU5QLHVDQU10QkMs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LE1BQTFCLEdBQXFDakYsQ0FGeEMsR0FHQyxnQ0FBQyxvQkFBRCxFQUNFLE1BQU0sQ0FBRWlDLEVBRFYsQ0FFRSxPQUFPLENBQUVDLEVBRlgsQ0FHRSxRQUFRLENBQUV0QyxDQUhaLENBSUUsVUFBVSxDQUFFMkIsRUFKZCxDQUtFLFVBQVUsQ0FBRWpDLENBTGQsQ0FNRSxRQUFRLENBQUUsa0JBQUNvRCxDQUFELFFBQU9ELENBQUFBLEVBQWMsQ0FBQ0MsQ0FBRCxDQUFyQixDQU5aLENBT0UsY0FBYyxDQUFFYixFQVBsQixFQTVESixDQWhCRixDQURELENBMEZDLEVBakhKLENBcUhILENBM1RELENBNlRBbEQsV0FBVyxDQUFDdUcsWUFBWixDQUEyQixDQUN6QjdELEtBQUssR0FEb0IsQ0FFekJFLFVBQVUsR0FGZSxDQUd6QkMsb0JBQW9CLEdBSEssQ0FJekIyQixrQkFBa0IsR0FKTyxDLGNBU1p4RSxXIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZUNhbGxiYWNrLCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBmZXRjaCBmcm9tIFwiaXNvbW9ycGhpYy11bmZldGNoXCI7XG5pbXBvcnQge1xuICBGb3JtQ29uZmlybWF0aW9uLFxuICBGb3JtRXJyb3IsXG4gIFJlbmRlckZpZWxkcyxcbiAgU3VibWl0LFxuICBQcm9ncmVzc0Jhcixcbn0gZnJvbSBcIi4vRm9ybUVsZW1lbnRzXCI7XG5cbmltcG9ydCB7XG4gIGNoZWNrQ29uZGl0aW9uYWxMb2dpYyxcbiAgZmV0Y2hGb3JtLFxuICBmb3JjZVZhbGlkYXRpb24sXG4gIG5leHRTdGVwLFxuICBwcmV2U3RlcCxcbiAgc2Nyb2xsVG9Db25maXJtYXRpb24sXG4gIHNldFRvdWNoZWRIYW5kbGVyLFxuICB1bnNldEVycm9yLFxuICB1cGRhdGVGaWVsZHNWYWx1ZXNCYXNlZE9uRW50cnksXG4gIHVwZGF0ZUZvcm1IYW5kbGVyLFxufSBmcm9tIFwiLi9IZWxwZXJzL2Zvcm1cIjtcblxuaW1wb3J0IHsgdmFsaWRhdGVGaWVsZCB9IGZyb20gXCIuL0hlbHBlcnMvdmFsaWRhdGlvblwiO1xuXG5jb25zdCBHcmF2aXR5Rm9ybSA9IChwcm9wcykgPT4ge1xuICBjb25zdCB7IGluaXRpYWxQYWdlLCBwb3B1bGF0ZWRFbnRyeSwgb25DaGFuZ2UgfSA9IHByb3BzO1xuXG4gIGNvbnN0IFtzdWJtaXRGYWlsZWQsIHNldFN1Ym1pdEZhaWxlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtlcnJvck1lc3NhZ2VzLCBzZXRFcnJvck1lc3NhZ2VzXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2Zvcm1WYWx1ZXMsIHNldEZvcm1WYWx1ZXNdID0gdXNlU3RhdGUoe30pO1xuICBjb25zdCBbc3VibWl0dGluZywgc2V0U3VibWl0dGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzdWJtaXRTdWNjZXNzLCBzZXRTdWJtaXRTdWNjZXNzXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2NvbmZpcm1hdGlvbk1lc3NhZ2UsIHNldENvbmZpcm1hdGlvbk1lc3NhZ2VdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZm9ybURhdGEsIHNldEZvcm1EYXRhXSA9IHVzZVN0YXRlKHt9KTtcbiAgY29uc3QgW3RvdWNoZWQsIHNldFRvdWNoZWRdID0gdXNlU3RhdGUoe30pO1xuICBjb25zdCBbYWN0aXZlUGFnZSwgc2V0QWN0aXZlUGFnZV0gPSB1c2VTdGF0ZShpbml0aWFsUGFnZSB8fCAxKTtcbiAgY29uc3QgW2NvbmRpdGlvbkZpZWxkcywgc2V0Q29uZGl0aW9uRmllbGRzXSA9IHVzZVN0YXRlKHt9KTtcbiAgY29uc3QgW2NvbmRpdGlvbmFsSWRzLCBzZXRDb25kaXRpb25hbElkc10gPSB1c2VTdGF0ZSh7fSk7XG4gIGNvbnN0IFtpc011bHRpcGFydCwgc2V0SXNNdWx0aVBhcnRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcGFnZUNsaWNrZWQsIHNldFBhZ2VDbGlja2VkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3Nob3dQYWdlVmFsaWRhdGlvbk1zZywgc2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3BhZ2VzLCBzZXRQYWdlc10gPSB1c2VTdGF0ZSh7fSk7XG5cbiAgY29uc3Qgd3JhcHBlclJlZiA9IHVzZVJlZihudWxsKTtcblxuICBjb25zdCB1cGRhdGVFbnRyeUZpZWxkcyA9IHVzZUNhbGxiYWNrKChwb3B1bGF0ZWRFbnRyeSkgPT4ge1xuICAgIHVwZGF0ZUZpZWxkc1ZhbHVlc0Jhc2VkT25FbnRyeShwb3B1bGF0ZWRFbnRyeSk7XG4gIH0sIFtdKTtcblxuICAvKipcbiAgICogRmV0Y2ggZm9ybSBkYXRhXG4gICAqL1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGZldGNoRm9ybSh7XG4gICAgICBzZXRGb3JtRGF0YSxcbiAgICAgIHNldEZvcm1WYWx1ZXMsXG4gICAgICBzZXRBY3RpdmVQYWdlLFxuICAgICAgc2V0Q29uZGl0aW9uRmllbGRzLFxuICAgICAgc2V0Q29uZGl0aW9uYWxJZHMsXG4gICAgICBzZXRQYWdlcyxcbiAgICAgIHNldElzTXVsdGlQYXJ0LFxuICAgICAgLi4ucHJvcHMsXG4gICAgfSk7XG4gIH0sIFtdKTtcblxuICAvKipcbiAgICogQ2FsbCBjdXN0b20gb25DaGFuZ2UgaGFuZGxlciB3aXRoIHBhc3NlZCB2YWx1ZXMgZnJvbSBmb3JtXG4gICAqL1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChvbkNoYW5nZSkge1xuICAgICAgb25DaGFuZ2UoZm9ybVZhbHVlcyk7XG4gICAgfVxuICB9LCBbZm9ybVZhbHVlc10pO1xuXG4gIC8qKlxuICAgKiBTZXQgZW50cnkgdG8gdGhlIGZvcm1cbiAgICovXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHBvcHVsYXRlZEVudHJ5KSB7XG4gICAgICB1cGRhdGVFbnRyeUZpZWxkcyhwb3B1bGF0ZWRFbnRyeSk7XG4gICAgfVxuICB9LCBbcG9wdWxhdGVkRW50cnldKTtcblxuICAvKipcbiAgICogU2Nyb2xsIHBhZ2UgdG8gdGhlIGZpcnN0IG5vdCB2YWxpZCBmaWVsZFxuICAgKi9cbiAgY29uc3Qgc2Nyb2xsVG9GaXJzdEludmFsaWRGaWVsZCA9ICgpID0+IHtcbiAgICBpZiAoIXdyYXBwZXJSZWYpIHJldHVybjtcblxuICAgIGNvbnN0IGZpcnN0RXJyRWwgPSB3cmFwcGVyUmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtLWZpZWxkLmVycm9yXCIpO1xuICAgIGlmIChmaXJzdEVyckVsKSB7XG4gICAgICBmaXJzdEVyckVsLnNjcm9sbEludG9WaWV3KCk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHtcbiAgICB0aXRsZSxcbiAgICBmb3JtSUQsXG4gICAgc3VibWl0SWNvbixcbiAgICBzYXZlU3RhdGVUb0h0bWxGaWVsZCxcbiAgICBzdHlsZWRDb21wb25lbnRzLFxuICAgIGN1c3RvbUNvbXBvbmVudHMsXG4gICAgZXJyb3JNZXNzYWdlLFxuICAgIGRyb3B6b25lVGV4dCxcbiAgICBsb2FkaW5nU3Bpbm5lcixcbiAgICBvbkVycm9yLFxuICAgIGxhbmd1YWdlLFxuICAgIGFwaUtleXMsXG4gIH0gPSBwcm9wcztcblxuICBjb25zdCB7XG4gICAgQnV0dG9uLFxuICAgIExvYWRpbmcsXG4gICAgRm9ybUVycm9yOiBTRm9ybUVycm9yLFxuICAgIEZvcm1Db25maXJtYXRpb246IFNGb3JtQ29uZmlybWF0aW9uLFxuICAgIEdGV3JhcHBlciA9IFwiZGl2XCIsXG4gIH0gPSBzdHlsZWRDb21wb25lbnRzIHx8IGZhbHNlO1xuXG4gIGNvbnN0IHsgY3NzQ2xhc3MgfSA9IGZvcm1EYXRhO1xuXG4gIGNvbnN0IGhhbmRsZVByZXZTdGVwID0gKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgcHJldlN0ZXAoZm9ybVZhbHVlcywgcGFnZXMsIGFjdGl2ZVBhZ2UsIHNldEFjdGl2ZVBhZ2UsIHNldFBhZ2VDbGlja2VkKTtcbiAgfTtcblxuICBjb25zdCBvblN1Ym1pdCA9IGFzeW5jIChldmVudCkgPT4ge1xuICAgIGNvbnN0IHsgb25TdWJtaXQ6IGN1c3RvbU9uU3VibWl0IH0gPSBwcm9wcztcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShldmVudC50YXJnZXQpO1xuXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGlzRm9ybVZhbGlkID0gZm9yY2VWYWxpZGF0aW9uKFxuICAgICAgYWN0aXZlUGFnZSxcbiAgICAgIGZvcm1WYWx1ZXMsXG4gICAgICBzZXRTaG93UGFnZVZhbGlkYXRpb25Nc2csXG4gICAgICBzZXRUb3VjaGVkXG4gICAgKTtcblxuICAgIGlmICghaXNGb3JtVmFsaWQpIHtcbiAgICAgIHNjcm9sbFRvRmlyc3RJbnZhbGlkRmllbGQoKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoY3VzdG9tT25TdWJtaXQpIHtcbiAgICAgIGN1c3RvbU9uU3VibWl0KGZvcm1EYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0U3VibWl0dGluZyh0cnVlKTtcbiAgICAgIHNldFN1Ym1pdFN1Y2Nlc3MoZmFsc2UpO1xuICAgICAgc2V0U3VibWl0RmFpbGVkKGZhbHNlKTtcbiAgICAgIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UoZmFsc2UpO1xuICAgICAgc2V0RXJyb3JNZXNzYWdlcyhmYWxzZSk7XG5cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZm9ybUlELFxuICAgICAgICBiYWNrZW5kVXJsLFxuICAgICAgICBqdW1wVG9Db25maXJtYXRpb24sXG4gICAgICAgIG9uU3VibWl0U3VjY2VzcyxcbiAgICAgICAgb25FcnJvcixcbiAgICAgIH0gPSBwcm9wcztcbiAgICAgIGNvbnN0IGdmU3VibWlzc2lvblVybCA9IGJhY2tlbmRVcmwuc3Vic3RyaW5nKFxuICAgICAgICAwLFxuICAgICAgICBiYWNrZW5kVXJsLmluZGV4T2YoXCIvd3AtanNvblwiKVxuICAgICAgKTtcblxuICAgICAgZmV0Y2goYCR7Z2ZTdWJtaXNzaW9uVXJsfS93cC1qc29uL2dmL3YyL2Zvcm1zLyR7Zm9ybUlEfS9zdWJtaXNzaW9uc2AsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICB9KVxuICAgICAgICAudGhlbigocmVzcCkgPT4gcmVzcC5qc29uKCkpXG4gICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5pc192YWxpZCkge1xuICAgICAgICAgICAgaWYgKG9uU3VibWl0U3VjY2Vzcykge1xuICAgICAgICAgICAgICBjb25zdCByZXMgPSBvblN1Ym1pdFN1Y2Nlc3MocmVzcG9uc2UpO1xuICAgICAgICAgICAgICBpZiAoIXJlcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY29uZmlybWF0aW9uTWVzc2FnZSA9IHJlc3BvbnNlLmNvbmZpcm1hdGlvbl9tZXNzYWdlO1xuICAgICAgICAgICAgY29uc3QgeyB0eXBlLCBsaW5rIH0gPSBjb25maXJtYXRpb25NZXNzYWdlIHx8IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHR5cGUgJiYgbGluayAmJiB0eXBlID09PSBcInJlZGlyZWN0XCIpIHtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShsaW5rKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgc2V0U3VibWl0U3VjY2Vzcyh0cnVlKTtcbiAgICAgICAgICAgIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UoY29uZmlybWF0aW9uTWVzc2FnZSk7XG5cbiAgICAgICAgICAgIGlmIChqdW1wVG9Db25maXJtYXRpb24pIHtcbiAgICAgICAgICAgICAgc2Nyb2xsVG9Db25maXJtYXRpb24ocHJvcHMsIHdyYXBwZXJSZWYsIGp1bXBUb0NvbmZpcm1hdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IHtcbiAgICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZXMgPVxuICAgICAgICAgICAgZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UudmFsaWRhdGlvbl9tZXNzYWdlc1xuICAgICAgICAgICAgICA/IGVycm9yLnJlc3BvbnNlLnZhbGlkYXRpb25fbWVzc2FnZXNcbiAgICAgICAgICAgICAgOiBcIlNvbWV0aGluZyB3ZW50IHdyb25nXCI7XG5cbiAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgb25FcnJvcihlcnJvck1lc3NhZ2VzKTtcbiAgICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgc2V0U3VibWl0RmFpbGVkKHRydWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICAgIHNldFN1Ym1pdEZhaWxlZCh0cnVlKTtcbiAgICAgICAgICAgIHNldEVycm9yTWVzc2FnZXMoZXJyb3JNZXNzYWdlcyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGp1bXBUb0NvbmZpcm1hdGlvbikge1xuICAgICAgICAgICAgc2Nyb2xsVG9Db25maXJtYXRpb24ocHJvcHMsIHdyYXBwZXJSZWYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPEdGV3JhcHBlclxuICAgICAgcmVmPXt3cmFwcGVyUmVmfVxuICAgICAgY2xhc3NOYW1lPVwiZm9ybS13cmFwcGVyXCJcbiAgICAgIGlkPXtgZ3Jhdml0eV9mb3JtXyR7Zm9ybUlEfWB9XG4gICAgPlxuICAgICAge2Zvcm1EYXRhLnRpdGxlID8gbnVsbCA6IExvYWRpbmcgJiYgPExvYWRpbmcgaXNMb2FkaW5nIC8+fVxuXG4gICAgICB7c3VibWl0RmFpbGVkICYmICFzdWJtaXRTdWNjZXNzICYmICFvbkVycm9yICYmIChcbiAgICAgICAgPEZvcm1FcnJvclxuICAgICAgICAgIFNGb3JtRXJyb3I9e1NGb3JtRXJyb3IgfHwgZmFsc2V9XG4gICAgICAgICAgZXJyb3JNZXNzYWdlPXtcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSB8fCBcIlRoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB5b3VyIHN1Ym1pc3Npb25cIlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICl9XG5cbiAgICAgIHtzdWJtaXRTdWNjZXNzICYmIGNvbmZpcm1hdGlvbk1lc3NhZ2UgJiYgKFxuICAgICAgICA8Rm9ybUNvbmZpcm1hdGlvblxuICAgICAgICAgIGNvbmZpcm1hdGlvbj17Y29uZmlybWF0aW9uTWVzc2FnZX1cbiAgICAgICAgICBTRm9ybUNvbmZpcm1hdGlvbj17U0Zvcm1Db25maXJtYXRpb259XG4gICAgICAgIC8+XG4gICAgICApfVxuXG4gICAgICB7IXN1Ym1pdFN1Y2Nlc3MgJiYgZm9ybURhdGEuZmllbGRzID8gKFxuICAgICAgICA8Zm9ybVxuICAgICAgICAgIG9uU3VibWl0PXsoZXZlbnQpID0+IG9uU3VibWl0KGV2ZW50KX1cbiAgICAgICAgICBjbGFzc05hbWU9e2Nzc0NsYXNzfVxuICAgICAgICAgIGVuY1R5cGU9e2lzTXVsdGlwYXJ0ID8gXCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIgOiB1bmRlZmluZWR9XG4gICAgICAgICAgbm9WYWxpZGF0ZVxuICAgICAgICA+XG4gICAgICAgICAgeyhmb3JtRGF0YS50aXRsZSB8fCBmb3JtRGF0YS5kZXNjcmlwdGlvbikgJiYgKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAge2Zvcm1EYXRhLnRpdGxlICYmIHRpdGxlID8gKFxuICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJmb3JtLXRpdGxlXCI+e2Zvcm1EYXRhLnRpdGxlfTwvaDM+XG4gICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICB7Zm9ybURhdGEuZGVzY3JpcHRpb24gPyAoXG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZm9ybS1kZXNjcmlwdGlvblwiPntmb3JtRGF0YS5kZXNjcmlwdGlvbn08L3A+XG4gICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0td3JhcHBlclwiPlxuICAgICAgICAgICAge2Zvcm1EYXRhPy5wYWdpbmF0aW9uPy5wYWdlcyAmJiAoXG4gICAgICAgICAgICAgIDxQcm9ncmVzc0JhclxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb249e2Zvcm1EYXRhLnBhZ2luYXRpb259XG4gICAgICAgICAgICAgICAgYWN0aXZlUGFnZT17YWN0aXZlUGFnZX1cbiAgICAgICAgICAgICAgICBmaXJzdFBhZ2VDc3NDbGFzcz17Zm9ybURhdGEuZmlyc3RQYWdlQ3NzQ2xhc3N9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPFJlbmRlckZpZWxkc1xuICAgICAgICAgICAgICBzdHlsZWRDb21wb25lbnRzPXtzdHlsZWRDb21wb25lbnRzfVxuICAgICAgICAgICAgICBjdXN0b21Db21wb25lbnRzPXtjdXN0b21Db21wb25lbnRzfVxuICAgICAgICAgICAgICBmaWVsZHM9e2Zvcm1EYXRhLmZpZWxkc31cbiAgICAgICAgICAgICAgZm9ybVZhbHVlcz17Zm9ybVZhbHVlc31cbiAgICAgICAgICAgICAgc3VibWl0RmFpbGVkPXtzdWJtaXRGYWlsZWR9XG4gICAgICAgICAgICAgIHN1Ym1pdFN1Y2Nlc3M9e3N1Ym1pdFN1Y2Nlc3N9XG4gICAgICAgICAgICAgIHVwZGF0ZUZvcm09eyhldmVudCwgZmllbGQsIGlucHV0SUQpID0+XG4gICAgICAgICAgICAgICAgdXBkYXRlRm9ybUhhbmRsZXIoXG4gICAgICAgICAgICAgICAgICBmaWVsZCxcbiAgICAgICAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgICAgICAgaW5wdXRJRCxcbiAgICAgICAgICAgICAgICAgIGZvcm1WYWx1ZXMsXG4gICAgICAgICAgICAgICAgICBzZXRGb3JtVmFsdWVzLFxuICAgICAgICAgICAgICAgICAgY29uZGl0aW9uYWxJZHMsXG4gICAgICAgICAgICAgICAgICBjb25kaXRpb25GaWVsZHNcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdG91Y2hlZD17dG91Y2hlZH1cbiAgICAgICAgICAgICAgc2V0VG91Y2hlZD17KGlkKSA9PiBzZXRUb3VjaGVkSGFuZGxlcihpZCwgdG91Y2hlZCwgc2V0VG91Y2hlZCl9XG4gICAgICAgICAgICAgIHNldEVycm9yTWVzc2FnZXM9e3NldEVycm9yTWVzc2FnZXN9XG4gICAgICAgICAgICAgIHBhZ2luYXRpb249e2Zvcm1EYXRhLnBhZ2luYXRpb259XG4gICAgICAgICAgICAgIGFjdGl2ZVBhZ2U9e2FjdGl2ZVBhZ2V9XG4gICAgICAgICAgICAgIHByZXZTdGVwPXsoZSkgPT4gaGFuZGxlUHJldlN0ZXAoZSl9XG4gICAgICAgICAgICAgIG5leHRTdGVwPXsoZSkgPT5cbiAgICAgICAgICAgICAgICBuZXh0U3RlcChcbiAgICAgICAgICAgICAgICAgIGUsXG4gICAgICAgICAgICAgICAgICBwcm9wcyxcbiAgICAgICAgICAgICAgICAgIHBhZ2VzLFxuICAgICAgICAgICAgICAgICAgZm9ybVZhbHVlcyxcbiAgICAgICAgICAgICAgICAgIGFjdGl2ZVBhZ2UsXG4gICAgICAgICAgICAgICAgICBzZXRBY3RpdmVQYWdlLFxuICAgICAgICAgICAgICAgICAgc2V0UGFnZUNsaWNrZWQsXG4gICAgICAgICAgICAgICAgICBzZXRUb3VjaGVkLFxuICAgICAgICAgICAgICAgICAgc2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNoZWNrQ29uZGl0aW9uYWxMb2dpYz17KGNvbmRpdGlvbiwgZmllbGRzKSA9PlxuICAgICAgICAgICAgICAgIGNoZWNrQ29uZGl0aW9uYWxMb2dpYyhjb25kaXRpb24sIChmaWVsZHMgPSBmYWxzZSkpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc2F2ZVN0YXRlVG9IdG1sRmllbGQ9e3NhdmVTdGF0ZVRvSHRtbEZpZWxkfVxuICAgICAgICAgICAgICBlbmFibGVIb25leXBvdD17Zm9ybURhdGEuZW5hYmxlSG9uZXlwb3R9XG4gICAgICAgICAgICAgIGVycm9ycz17ZXJyb3JNZXNzYWdlc31cbiAgICAgICAgICAgICAgdW5zZXRFcnJvcj17KGlkKSA9PiB1bnNldEVycm9yKGlkLCBlcnJvck1lc3NhZ2VzKX1cbiAgICAgICAgICAgICAgZHJvcHpvbmVUZXh0PXtkcm9wem9uZVRleHR9XG4gICAgICAgICAgICAgIHBhZ2VDbGlja2VkPXtwYWdlQ2xpY2tlZH1cbiAgICAgICAgICAgICAgbGFuZ3VhZ2U9e2xhbmd1YWdlfVxuICAgICAgICAgICAgICBhcGlLZXlzPXthcGlLZXlzfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHsoIWZvcm1EYXRhLnBhZ2luYXRpb24gfHxcbiAgICAgICAgICAgICAgKGZvcm1EYXRhLnBhZ2luYXRpb24gJiZcbiAgICAgICAgICAgICAgICBmb3JtRGF0YS5wYWdpbmF0aW9uLnBhZ2VzLmxlbmd0aCA9PT0gYWN0aXZlUGFnZSkpICYmIChcbiAgICAgICAgICAgICAgPFN1Ym1pdFxuICAgICAgICAgICAgICAgIEJ1dHRvbj17QnV0dG9ufVxuICAgICAgICAgICAgICAgIExvYWRpbmc9e0xvYWRpbmd9XG4gICAgICAgICAgICAgICAgZm9ybURhdGE9e2Zvcm1EYXRhfVxuICAgICAgICAgICAgICAgIHN1Ym1pdEljb249e3N1Ym1pdEljb259XG4gICAgICAgICAgICAgICAgc3VibWl0dGluZz17c3VibWl0dGluZ31cbiAgICAgICAgICAgICAgICBwcmV2U3RlcD17KGUpID0+IGhhbmRsZVByZXZTdGVwKGUpfVxuICAgICAgICAgICAgICAgIGxvYWRpbmdTcGlubmVyPXtsb2FkaW5nU3Bpbm5lcn1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZm9ybT5cbiAgICAgICkgOiAoXG4gICAgICAgIFwiXCJcbiAgICAgICl9XG4gICAgPC9HRldyYXBwZXI+XG4gICk7XG59O1xuXG5HcmF2aXR5Rm9ybS5kZWZhdWx0UHJvcHMgPSB7XG4gIHRpdGxlOiB0cnVlLFxuICBzdWJtaXRJY29uOiBmYWxzZSxcbiAgc2F2ZVN0YXRlVG9IdG1sRmllbGQ6IGZhbHNlLFxuICBqdW1wVG9Db25maXJtYXRpb246IHRydWUsXG59O1xuXG5leHBvcnQgeyB2YWxpZGF0ZUZpZWxkLCBGb3JtQ29uZmlybWF0aW9uLCBGb3JtRXJyb3IsIFJlbmRlckZpZWxkcywgU3VibWl0IH07XG5cbmV4cG9ydCBkZWZhdWx0IEdyYXZpdHlGb3JtO1xuIl19